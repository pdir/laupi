"use strict";angular.module("route360DemoApp",["ngRoute","ngTouch","cfg","ui.checkbox","ngTable","ui.bootstrap","isteven-multi-select"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/map.html",controller:"MapCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("cfg",[]).constant("$config",{mapboxId:"mi.94c056dc",maxAutoCompletes:1,markerMinPercent:.6,markerMaxPercent:.9,notyLayout:"topCenter",isProduction:!0}),r360.config.i18n.language="de",r360.config.i18n.configuredLanguages=["de"],r360.config.serviceUrl="http://api.route360.net/api_brandenburg/",r360.config.serviceKey="uhWrWpUhyZQy8rPfiC7X",r360.config.defaultPolygonLayerOptions.strokeWidth=20,r360.config.defaultPolygonLayerOptions.tolerance=13,angular.module("route360DemoApp").controller("NavCtrl",["$scope","$location",function(a,b){a.navClass=function(a){var c=b.path().substring(1)||"home";return a===c?"active":""},a.loadHome=function(){b.url("/")},a.loadContact=function(){b.url("/contact")},a.loadAbout=function(){b.url("/about")},a.loadTest=function(){b.url("/test")}}]),angular.module("route360DemoApp").controller("MapCtrl",["$window","$http","$scope","$config","ngTableParams","$timeout","TableParamFactory","PolygonService",function(a,b,c,d,e,f,g,h){c.travelDate="20150717",c.travelTime="61200",c.source=void 0,c.markerColorsHex=["#338433","#BC5A1D","#B71632","#226CBE","#4F2474","#656565"],c.markerColors=["green","orange","red","blue","purple","grey"],c.laupisDatabase=[{uriident:"kleingarten-nahe-bad-doberan-8-km-bis-zur-ostsee-p-81","css-filter-class-string":"estate flaechen-gesamtflaeche-400-500 laupi-hausart-steinhaus laupi-hausflaeche-20-30 laupi-eigentumsart-teileigentum preise-kaufpreisbrutto-10000-20000","freitexte-objekttitel":"Kleingarten nahe Bad Doberan, 8 km bis zur Ostsee","anhaenge-anhang-#1-@gruppe":"BILD","anhaenge-anhang-#1-daten-pfad":"assets/images/c/P-81_10_%20Kleingarten_Wochenendgrundstueck_Bad_Doberan_Laupi_Berlin-1731127c.jpg","anhaenge-anhang-#1-format":".jpg","anhaenge-anhang-#1-anhangtitel":"10__Kleingarten_Wochenendgrundstueck_Bad_Doberan_Laupi_Berlin.jpg","geo-plz":"18209","geo-ort":"Bad Doberan","flaechen-gesamtflaeche":"400.00","laupi-hausart":"Steinhaus","laupi-hausflaeche":"24.00","laupi-eigentumsart":"Teileigentum","preise-kaufpreisbrutto":"10292.00","laupi-objektart":"Kleingarten","geo-lat":"54.0900000","geo-lon":"11.9300000","geo-lat_forged":"54.0900000","geo-lon_forged":"11.9300000"},{uriident:"wochenendgrundstueck-in-beelitz-nahe-bei-potsdam-und-berlin-p-246","css-filter-class-string":"estate flaechen-gesamtflaeche-400-500 laupi-hausart-blockbohlenhaus laupi-hausflaeche-20-30 laupi-eigentumsart-pacht preise-kaufpreisbrutto-1-10000","freitexte-objekttitel":"Wochenendgrundstück in Beelitz, nahe bei Potsdam und Berlin","anhaenge-anhang-#1-@gruppe":null,"anhaenge-anhang-#1-daten-pfad":null,"anhaenge-anhang-#1-format":null,"anhaenge-anhang-#1-anhangtitel":null,"geo-plz":"14547","geo-ort":"Beelitz","flaechen-gesamtflaeche":"467.00","laupi-hausart":"Blockbohlenhaus","laupi-hausflaeche":"24.00","laupi-eigentumsart":"Pacht","preise-kaufpreisbrutto":"8667.00","laupi-objektart":"Wochenendgrundstück","geo-lat":"52.2200000","geo-lon":"12.9700000","geo-lat_forged":"52.2200000","geo-lon_forged":"12.9700000"},{uriident:"kleingarten-in-templin-in-seenreicher-umgebung-75-km-von-berlin-p-205","css-filter-class-string":"estate flaechen-gesamtflaeche-400-500 laupi-hausart-steinhaus laupi-hausflaeche-20-30 laupi-eigentumsart-pacht preise-kaufpreisbrutto-20000-30000","freitexte-objekttitel":"Kleingarten in Templin, in seenreicher Umgebung, 75 km von Berlin","anhaenge-anhang-#1-@gruppe":"BILD","anhaenge-anhang-#1-daten-pfad":"assets/images/2/P-205_10_Kleingarten_Wochenendhaus_Templin_Laupi_Berlin-aff86632.jpg","anhaenge-anhang-#1-format":".jpg","anhaenge-anhang-#1-anhangtitel":"10_Kleingarten_Wochenendhaus_Templin_Laupi_Berlin.jpg","geo-plz":"","geo-ort":"Templin","flaechen-gesamtflaeche":"400.00","laupi-hausart":"Steinhaus","laupi-hausflaeche":"28.00","laupi-eigentumsart":"Pacht","preise-kaufpreisbrutto":"21666.00","laupi-objektart":"Kleingarten","geo-lat":"53.1200000","geo-lon":"13.5000000","geo-lat_forged":"53.1200000","geo-lon_forged":"13.5000000"},{uriident:"wochendendhaus-am-schervenzsee-im-schlaubetal-nicht-weit-bis-frankfurtioder-p-244","css-filter-class-string":"estate flaechen-gesamtflaeche-200-300 laupi-hausart-ddr-bungalow laupi-hausflaeche-30-40 laupi-eigentumsart-pacht preise-kaufpreisbrutto-1-10000","freitexte-objekttitel":"Wochendendhaus am Schervenzsee im Schlaubetal, nicht weit bis Frankfurt/IOder","anhaenge-anhang-#1-@gruppe":"BILD","anhaenge-anhang-#1-daten-pfad":"","anhaenge-anhang-#1-format":".jpg","anhaenge-anhang-#1-anhangtitel":"10_WochenendgrundstÃ¼ck_Schervenzsee_Laupi_Berlin.jpg","geo-plz":"15890","geo-ort":"Schernsdorf","flaechen-gesamtflaeche":"250.00","laupi-hausart":"DDR-Bungalow","laupi-hausflaeche":"34.00","laupi-eigentumsart":"Pacht","preise-kaufpreisbrutto":"5595.00","laupi-objektart":"Wochenendgrundstück","geo-lat":"52.1800000","geo-lon":"14.4400000","geo-lat_forged":"52.1900000","geo-lon_forged":"14.4600000"},{uriident:"grosses-wochenendgrundstueck-in-golssen-am-rande-des-spreewalds-p-150","css-filter-class-string":"estate flaechen-gesamtflaeche-1400-1500 laupi-hausart-holzhaus laupi-hausflaeche-10-20 laupi-eigentumsart-eigentum preise-kaufpreisbrutto-10000-20000","freitexte-objekttitel":"Großes Wochenendgrundstück in Golßen am Rande des Spreewalds","anhaenge-anhang-#1-@gruppe":"BILD","anhaenge-anhang-#1-daten-pfad":"assets/images/5/P-150_2_Wochenendgrundstueck_Gartengrundstueck_Golssen_Spreewald_Laupi_Berlin-10a102d5.jpg","anhaenge-anhang-#1-format":".jpg","anhaenge-anhang-#1-anhangtitel":"2_Wochenendgrundstueck_Gartengrundstueck_Golssen_Spreewald_Laupi_Berlin.jpg","geo-plz":"15938","geo-ort":"Golßen","flaechen-gesamtflaeche":"1400.00","laupi-hausart":"Holzhaus","laupi-hausflaeche":"12.00","laupi-eigentumsart":"Eigentum","preise-kaufpreisbrutto":"16250.00","laupi-objektart":"Wochenendgrundstück","geo-lat":"0.0000000","geo-lon":"0.0000000","geo-lat_forged":"51.9700000","geo-lon_forged":"13.6000000"},{uriident:"romantische-scheune-mit-garten-in-seenaehe-180-km-von-berlin-20-km-bis-guestrow-p-126","css-filter-class-string":"estate flaechen-gesamtflaeche-700-800 laupi-hausart-steinhaus laupi-hausflaeche-60-70 laupi-eigentumsart-eigentum preise-kaufpreisbrutto-40000-50000","freitexte-objekttitel":"Romantische Scheune mit Garten in Seenähe, 180 km von Berlin, 20 km bis Güstrow","anhaenge-anhang-#1-@gruppe":null,"anhaenge-anhang-#1-daten-pfad":null,"anhaenge-anhang-#1-format":null,"anhaenge-anhang-#1-anhangtitel":null,"geo-plz":"18292","geo-ort":"Koppelow","flaechen-gesamtflaeche":"717.00","laupi-hausart":"Steinhaus","laupi-hausflaeche":"60.00","laupi-eigentumsart":"Eigentum","preise-kaufpreisbrutto":"43332.00","laupi-objektart":"Wochenendgrundstück","geo-lat":"53.7000000","geo-lon":"12.3100000","geo-lat_forged":"53.6900000","geo-lon_forged":"12.3100000"},{uriident:"bungalow-zaue-am-schwielochsee-seenaehe-45-km-von-cottbus-p-158","css-filter-class-string":"estate flaechen-gesamtflaeche-200-300 laupi-hausart-steinhaus laupi-hausflaeche-30-40 laupi-eigentumsart-teileigentum preise-kaufpreisbrutto-20000-30000","freitexte-objekttitel":"Bungalow Zaue am Schwielochsee, Seenähe, 45 km von Cottbus","anhaenge-anhang-#1-@gruppe":"BILD","anhaenge-anhang-#1-daten-pfad":"assets/images/3/P-158_3_Wochenendgrundstueck_Wochenendhaus_Schlaubetal_See_Laupi_Berlin-153fae33.jpg","anhaenge-anhang-#1-format":".jpg","anhaenge-anhang-#1-anhangtitel":"3_Wochenendgrundstueck_Wochenendhaus_Schlaubetal_See_Laupi_Berlin.jpg","geo-plz":"15913","geo-ort":"Zaue am Schwielochsee","flaechen-gesamtflaeche":"250.00","laupi-hausart":"Steinhaus","laupi-hausflaeche":"38.00","laupi-eigentumsart":"Teileigentum","preise-kaufpreisbrutto":"21666.00","laupi-objektart":"Wochenendgrundstück","geo-lat":"52.0500000","geo-lon":"14.1900000","geo-lat_forged":"52.0600000","geo-lon_forged":"14.1900000"},{uriident:"wochenendhaus-in-berlin-nikolassee-nahe-wannsee-p-252","css-filter-class-string":"estate flaechen-gesamtflaeche-100-200 laupi-hausart-gartenhaus laupi-hausflaeche-20-30 laupi-eigentumsart-pacht preise-kaufpreisbrutto-20000-30000","freitexte-objekttitel":"Wochenendhaus in Berlin-Nikolassee, nahe Wannsee","anhaenge-anhang-#1-@gruppe":"BILD","anhaenge-anhang-#1-daten-pfad":"assets/images/e/P-252_01_Wochenendhaus_Berlin_Laupi-86a6af4e.jpg","anhaenge-anhang-#1-format":".jpg","anhaenge-anhang-#1-anhangtitel":"01_Wochenendhaus_Berlin_Laupi.jpg","geo-plz":"14109","geo-ort":"Berlin","flaechen-gesamtflaeche":"144.00","laupi-hausart":"Gartenhaus","laupi-hausflaeche":"21.00","laupi-eigentumsart":"Pacht","preise-kaufpreisbrutto":"22500.00","laupi-objektart":"Wochenendgrundstück","geo-lat":"52.4200000","geo-lon":"13.1900000","geo-lat_forged":"52.4200000","geo-lon_forged":"13.1900000"},{uriident:"kleingarten-in-fuerstenwalde-an-der-spree-30-km-bis-berlin-erkner-p-211","css-filter-class-string":"estate flaechen-gesamtflaeche-300-400 laupi-hausart-ddr-bungalow laupi-hausflaeche-30-40 laupi-eigentumsart-pacht preise-kaufpreisbrutto-10000-20000","freitexte-objekttitel":"Kleingarten in Fürstenwalde an der Spree, 30 km bis Berlin / Erkner","anhaenge-anhang-#1-@gruppe":null,"anhaenge-anhang-#1-daten-pfad":null,"anhaenge-anhang-#1-format":null,"anhaenge-anhang-#1-anhangtitel":null,"geo-plz":"15517","geo-ort":"Fürstenwalde","flaechen-gesamtflaeche":"386.00","laupi-hausart":"DDR-Bungalow","laupi-hausflaeche":"30.00","laupi-eigentumsart":"Pacht","preise-kaufpreisbrutto":"17333.00","laupi-objektart":"Kleingarten","geo-lat":"52.3400000","geo-lon":"14.0600000","geo-lat_forged":"52.3400000","geo-lon_forged":"14.0600000"},{uriident:"finnhuette-wochenendgrundstueck-niederlausitz-32-km-von-cottbus-p-206","css-filter-class-string":"estate flaechen-gesamtflaeche-400-500 laupi-hausart-finnhuette laupi-hausflaeche-40-50 laupi-eigentumsart-eigentum preise-kaufpreisbrutto-10000-20000","freitexte-objekttitel":"Finnhütte, Wochenendgrundstück Niederlausitz, 32 km von Cottbus","anhaenge-anhang-#1-@gruppe":null,"anhaenge-anhang-#1-daten-pfad":null,"anhaenge-anhang-#1-format":null,"anhaenge-anhang-#1-anhangtitel":null,"geo-plz":"02959","geo-ort":"Groß Düben","flaechen-gesamtflaeche":"487.00","laupi-hausart":"Finnhütte","laupi-hausflaeche":"42.00","laupi-eigentumsart":"Eigentum","preise-kaufpreisbrutto":"10833.00","laupi-objektart":"Wochenendgrundstück","geo-lat":"51.5800000","geo-lon":"14.5700000","geo-lat_forged":"51.5700000","geo-lon_forged":"14.5700000"},{uriident:"gartenhaus-keingarten-in-prenzlau-ganz-nah-am-unteruckersee-p-157","css-filter-class-string":"estate flaechen-gesamtflaeche-300-400 laupi-hausart-steinhaus laupi-hausflaeche-30-40 laupi-eigentumsart-pacht preise-kaufpreisbrutto-10000-20000","freitexte-objekttitel":"Gartenhaus / Keingarten in Prenzlau,  ganz nah am Unteruckersee","anhaenge-anhang-#1-@gruppe":null,"anhaenge-anhang-#1-daten-pfad":null,"anhaenge-anhang-#1-format":null,"anhaenge-anhang-#1-anhangtitel":null,"geo-plz":"17291","geo-ort":"Prenzlau","flaechen-gesamtflaeche":"300.00","laupi-hausart":"Steinhaus","laupi-hausflaeche":"38.00","laupi-eigentumsart":"Pacht","preise-kaufpreisbrutto":"10292.00","laupi-objektart":"Kleingarten","geo-lat":"53.3100000","geo-lon":"13.8600000","geo-lat_forged":"53.3100000","geo-lon_forged":"13.8500000"},{uriident:"kleingarten-in-eberswalde-seenaehe-schorfheide-p-249","css-filter-class-string":"estate flaechen-gesamtflaeche-300-400 laupi-hausart-steinhaus laupi-hausflaeche-20-30 laupi-eigentumsart-pacht preise-kaufpreisbrutto-1-10000","freitexte-objekttitel":"Kleingarten in Eberswalde, Seenähe, Schorfheide","anhaenge-anhang-#1-@gruppe":"BILD","anhaenge-anhang-#1-daten-pfad":"assets/images/6/P-249_10_Kleingarten_Eberswalde_Laupi_Berlin-02791296.jpg","anhaenge-anhang-#1-format":".jpg","anhaenge-anhang-#1-anhangtitel":"10_Kleingarten_Eberswalde_Laupi_Berlin.jpg","geo-plz":"16227","geo-ort":"Eberswalde","flaechen-gesamtflaeche":"300.00","laupi-hausart":"Steinhaus","laupi-hausflaeche":"25.00","laupi-eigentumsart":"Pacht","preise-kaufpreisbrutto":"8000.00","laupi-objektart":"Kleingarten","geo-lat":"52.8500000","geo-lon":"13.7300000","geo-lat_forged":"52.8500000","geo-lon_forged":"13.7300000"},{uriident:"wochenendhaus-rangsdorf-bauland-30-km-von-berlin-p-151","css-filter-class-string":"estate flaechen-gesamtflaeche-1200-1300 laupi-hausart-steinhaus laupi-hausflaeche-20-30 laupi-eigentumsart-pacht-ueber-bufim preise-kaufpreisbrutto-10000-20000","freitexte-objekttitel":"Wochenendhaus Rangsdorf, Bauland, 30 km von Berlin","anhaenge-anhang-#1-@gruppe":null,"anhaenge-anhang-#1-daten-pfad":null,"anhaenge-anhang-#1-format":null,"anhaenge-anhang-#1-anhangtitel":null,"geo-plz":"15834","geo-ort":"Rangsdorf","flaechen-gesamtflaeche":"1200.00","laupi-hausart":"Steinhaus","laupi-hausflaeche":"25.00","laupi-eigentumsart":"Pacht über BufIM","preise-kaufpreisbrutto":"12500.00","laupi-objektart":"Wochenendgrundstück","geo-lat":"52.2900000","geo-lon":"13.4500000","geo-lat_forged":"52.2900000","geo-lon_forged":"13.4600000"}],_.each(c.laupisDatabase,function(a){a.lat=a["geo-lat"],a.lng=a["geo-lon"],a.id=a.uriident}),c.laupis=angular.copy(c.laupisDatabase),c.laupis=_.reject(c.laupis,function(a){return 0==a.lat}),c.kaufpreis=[{value:1e4,name:"bis 10.000 €",ticked:!1},{value:2e4,name:"bis 20.000 €",ticked:!1},{value:3e4,name:"bis 30.000 €",ticked:!0},{value:4e4,name:"bis 40.000 €",ticked:!1},{value:5e4,name:"bis 50.000 €",ticked:!1},{value:6e4,name:"bis 60.000 €",ticked:!1}],c.eigentumsArt=[{value:"Eigentum",ticked:!0,name:"Eigentum"},{value:"Pacht",ticked:!0,name:"Pacht"},{value:"Pacht über BufIM",ticked:!0,name:"Pacht über BufIM"},{value:"Teileigentum",ticked:!0,name:"Teileigentum"}],c.grundstuecksFlaeche=[{value:200,ticked:!1,name:"bis 200 m²"},{value:300,ticked:!1,name:"bis 300 m²"},{value:400,ticked:!1,name:"bis 400 m²"},{value:500,ticked:!0,name:"bis 500 m²"},{value:800,ticked:!1,name:"bis 800 m²"},{value:1100,ticked:!1,name:"bis 1.100 m²"},{value:1300,ticked:!1,name:"bis 1.300 m²"},{value:1500,ticked:!1,name:"bis 1.500 m²"}],c.hausArt=[{ticked:!0,value:"Blockbohlenhaus",name:"Blockbohlenhaus"},{ticked:!0,value:"DDR-Bungalow",name:"DDR-Bungalow"},{ticked:!0,value:"Finnhütte",name:"Finnhütte"},{ticked:!0,value:"Gartenhaus",name:"Gartenhaus"},{ticked:!0,value:"Holzhaus",name:"Holzhaus"},{ticked:!0,value:"Steinhaus",name:"Steinhaus"}],c.hausFlaeche=[{ticked:!1,value:"20",name:"bis 20 m²"},{ticked:!1,value:"30",name:"bis 30 m²"},{ticked:!1,value:"40",name:"bis 40 m²"},{ticked:!0,value:"50",name:"bis 50 m²"},{ticked:!1,value:"60",name:"bis 60 m²"},{ticked:!1,value:"70",name:"bis 70 m²"}],$("#laupi-search-edit").show(),$("#laupi-search-edit").on("click",function(){$("#laupi-search-edit-modal").modal("show")}),$("#laupi-results").show(),$("#laupi-results").on("click",function(){c.laupisTableParams=g.create(c.laupis),c.$apply(),$("#laupi-results-modal").modal("show")}),L.Icon.Default.imagePath="images/marker/",c.map=L.map("map-laupi",{zoomControl:!1,scrollWheelZoom:!0}).setView([52.516389,13.377778],13);var i="<a href='https://www.mapbox.com/about/maps/' target='_blank'>© Mapbox © OpenStreetMap</a> | ÖPNV Daten © <a href='http://www.vbb.de/de/index.html' target='_blank'>VBB</a> | developed by <a href='http://www.route360.net/de/' target='_blank'>Route360°</a>";L.tileLayer("http://a.tiles.mapbox.com/v3/"+d.mapboxId+"/{z}/{x}/{y}.png",{maxZoom:18,attribution:i}).addTo(c.map),L.control.scale({metric:!0,imperial:!1}).addTo(c.map),r360.config.defaultTravelTimeControlOptions.travelTimes=[{time:1200,color:"#006837",opacity:1},{time:2400,color:"#39B54A",opacity:1},{time:3600,color:"#8CC63F",opacity:1},{time:4800,color:"#F7931E",opacity:1},{time:6e3,color:"#F15A24",opacity:1},{time:7200,color:"#C1272D",opacity:1}],c.travelTimeControl=r360.travelTimeControl({travelTimes:r360.config.defaultTravelTimeControlOptions.travelTimes,position:"topright",label:"Reisezeit",unit:"min",initValue:60}),c.map.addControl(c.travelTimeControl),c.polygonButtons=r360.radioButtonControl({buttons:[{label:'<span class=""></span> Farbig',key:"color",checked:!1},{label:'<span class=""></span> Schwarz/Weiß',key:"inverse",checked:!0}]}),c.polygonButtons.onChange(function(){c.polygonLayer.setInverse("color"==c.polygonButtons.getValue()?!1:!0),c.showLaupis()}),c.polygonButtons.addTo(c.map),L.control.zoom({position:"topright"}).addTo(c.map),c.waitControl=r360.waitControl({position:"bottomright"}),c.map.addControl(c.waitControl),c.travelTimeControl.onSlideStop(function(){c.showLaupis(),c.$apply()}),c.laupiLayer=L.featureGroup().addTo(c.map),c.sourceLayer=L.featureGroup().addTo(c.map),c.routesLayer=L.featureGroup().addTo(c.map),c.polygonLayer=r360.leafletPolygonLayer({inverse:!0,extendWidthX:500,extendWidthY:500}),c.map.addLayer(c.polygonLayer),c.getPlaces=function(){c.sourceLayer.clearLayers();var a=L.icon({iconSize:[25,41],iconAnchor:[12,41],iconUrl:L.Icon.Default.imagePath+"marker-icon-"+c.markerColors[2]+".png",shadowUrl:L.Icon.Default.imagePath+"marker-shadow.png"});c.source=L.marker(c.autoComplete.getValue().latlng,{icon:a,draggable:!0}).addTo(c.sourceLayer),c.source.travelType=c.autoComplete.getTravelType(),c.source.on("dragend",function(a){r360.Util.getAddressByCoordinates(c.source.getLatLng(),"de",function(a){c.autoComplete.update(c.source.getLatLng(),r360.Util.formatReverseGeocoding(a)),c.showLaupis()})})},c.resize=function(){var a=$(".leaflet-top.leaflet-left").height(),b=$(".leaflet-top.leaflet-left").offset();$("#laupi-details").animate({top:a+b.top+10+"px"},250,function(){$("#laupi-details").css("max-height",$("#map-laupi").height()-a-20+"px")})},c.filterLaupis=function(){c.laupis=[],_.each(c.laupisDatabase,function(a){a["flaechen-gesamtflaeche"]<=c.getSelection(c.selectedGrundstuecksFlaeche)[0]&&a["laupi-hausflaeche"]<=c.getSelection(c.selectedHausFlaeche)[0]&&a["preise-kaufpreisbrutto"]<=c.getSelection(c.selectedKaufpreis)[0]&&_.contains(c.getSelection(c.selectedEigentumsArt),a["laupi-eigentumsart"])&&_.contains(c.getSelection(c.selectedHausArt),a["laupi-hausart"])&&c.laupis.push(a)})},c.getSelection=function(a){var b=[];return angular.forEach(a,function(a){a.ticked===!0&&b.push(a.value)}),b},c.showLaupis=function(){c.waitControl.show(),c.laupiLayer.clearLayers(),c.routesLayer.clearLayers(),$("#laupi-details").hide(),c.getPlaces(),c.noApartmentsInTravelTimeFound=!0,c.maxTime=c.travelTimeControl.getMaxValue();var a=r360.travelOptions();a.addSource(c.source),a.setTravelTimes(c.travelTimeControl.getValues()),a.setDate(c.travelDate),a.setTime(c.travelTime),r360.PolygonService.getTravelTimePolygons(a,function(a){if(c.polygonLayer.clearAndAddLayers(a,!0),0!=c.laupis.length){var b=r360.travelOptions();b.addSource(c.source),b.setTargets(c.laupis),b.setTravelTimes(c.travelTimeControl.getValues()),b.setMaxRoutingTime(c.travelTimeControl.getMaxValue()),b.setDate(c.travelDate),b.setTime(c.travelTime),r360.TimeService.getRouteTime(b,function(a){if(_.each(a[0].targets,function(a){var d=_.find(c.laupis,function(b){return b.uriident==a.id});d.travelTime=a.travelTime,-1==d.travelTime&&(d.travelTime=1e7);var e=c.createlaupiMarker(d,b);e.on("click",c.clickMarker(e,d,b))}),c.laupis.sort(function(a,b){return a.travelTime-b.travelTime}),c.tableParams=g.create(c.laupis),c.waitControl.hide(),c.noApartmentsInTravelTimeFound){noty({text:"Es gibt in den erreichbaren Gebieten keine Laupis die den Suchkriterien entsprechen.",timeout:3e3,layout:d.notyLayout,type:"error"})}})}else{c.waitControl.hide();noty({text:"Keine Objekte gefunden.",layout:d.notyLayout,type:"error",timeout:2e3})}})},c.showIncreaseTravelTimeQuestion=function(a){c.travelTimeControl.getMaxValue()/60<120&&noty({text:"Reisezeit erhöhen?",layout:d.notyLayout,buttons:[{addClass:"btn btn-primary",text:"Ja",onClick:function(b){c.travelTimeControl.setValue(Math.min(c.travelTimeControl.getMaxValue()/60+20,60)),c.showLaupis(),b.close(),a.close()}},{addClass:"btn btn-danger",text:"Nein",onClick:function(b){b.close(),a.close()}}]})},c.createlaupiMarker=function(a,b){var d,e;return-1!=a.travelTime&&void 0!=a.travelTime&&a.travelTime<=c.travelTimeControl.getMaxValue()&&h.pointInPolygon([a.lat,a.lng])?(e=L.icon({iconSize:[25,41],iconAnchor:[12,41],iconUrl:L.Icon.Default.imagePath+"marker-icon-"+c.markerColors[0]+".png",shadowUrl:L.Icon.Default.imagePath+"marker-shadow.png"}),c.noApartmentsInTravelTimeFound=!1):e=L.icon({iconSize:[25,41],iconAnchor:[12,41],iconUrl:L.Icon.Default.imagePath+"marker-icon-"+c.markerColors[5]+".png",shadowUrl:L.Icon.Default.imagePath+"marker-shadow.png"}),d=L.marker([a.lat,a.lng],{icon:e,draggable:!1}).addTo(c.laupiLayer)},c.clickMarker=function(a,b,d){return function(){c.laupi=b,c.routesLayer.clearLayers(),c.resize(),$("#laupi-details").show(),d.addSource(c.source),d.setTargets([a]),r360.RouteService.getRoutes(d,function(a){c.laupi.travelTime=a[0].travelTime,c.laupi.route=a[0],r360.LeafletUtil.fadeIn(c.routesLayer,c.laupi.route,1e3,"travelDistance",{transferColor:"#659742",transferHaloColor:"#4B7C27",transferFillOpacity:1,transferOpacity:1,transferStroke:!0,transferWeight:7,transferRadius:7}),c.$apply()})}},c.addAutoComplete=function(){c.autoComplete=r360.placeAutoCompleteControl({country:"Deutschland",placeholder:"Startpunkt",reset:!1,reverse:!1,image:L.Icon.Default.imagePath+"marker-icon-"+c.markerColors[2]+".png",options:{car:!0,bike:!0,walk:!0,transit:!0,biketransit:!0,init:"transit",labels:{bike:'<span class="fa fa-bicycle travel-type-icon"></span>',walk:'<span class="fa fa-male travel-type-icon"></span>',car:'<span class="fa fa-car travel-type-icon"></span>',transit:'<span class="fa fa-bus travel-type-icon"></span>',biketransit:'<span class="fa fa-bicycle travel-type-icon"></span> + <span class="fa fa-bus travel-type-icon"></span>'}},width:400});var a=function(){""!=c.autoComplete.getFieldValue()&&(c.autoComplete.reset(),c.polygonLayer.clearLayers(),c.routesLayer.clearLayers(),c.sourceLayer.clearLayers(),$("#laupi-details").hide())},b=function(){c.showLaupis()},d=function(){f(function(){c.resize()},320),c.showLaupis()};c.autoComplete.onSelect(b),c.autoComplete.onReset(a),c.autoComplete.onTravelTypeChange(d),c.map.addControl(c.autoComplete),c.resize()}(),$("#laupi-details").css("top","117px"),$("#laupi-details").on("mouseover",function(){c.map.scrollWheelZoom.disable()}),$("#laupi-details").on("mouseout",function(){c.map.scrollWheelZoom.enable()}),c.showResultView=function(){c.laupisTableParams=g.create(c.laupis),$("#laupi-results-modal").modal("show")},c.showEditSearchView=function(){$("#laupi-search-edit-modal").modal("show")},$("#close-expose").click(function(){$("#laupi-details").hide()}),$(".travel-type-buttons").click(function(){f(function(){c.resize()},320)}),c.map.on("resize",function(){c.resize()}),c.autoComplete.setFieldValue("Berlin, Berlin"),c.autoComplete.setValue({firstRow:"Berlin, Berlin",getLatLng:function(){return this.latlng},label:"Berlin, Berlin",latlng:L.latLng(52.517037,13.38886),secondRow:"Berlin",term:"Berlin",value:"Berlin, Berlin"}),c.showLaupis(),noty({text:"Man kann den Marker verscchieben",layout:d.notyLayout,type:"success",timeout:3e3}),c.resize(),$("[lang='en']").hide(),$("[lang='no']").hide()}]),angular.module("route360DemoApp").service("PolygonService",function(){this.pointInPolygon=function(b){for(var c=b[0],d=b[1],e=!1,f=0,g=a.length-1;f<a.length;g=f++){var h=a[f][0],i=a[f][1],j=a[g][0],k=a[g][1],l=i>d!=k>d&&(j-h)*(d-i)/(k-i)+h>c;l&&(e=!e)}return e};var a=[[53.35626,14.41545],[53.34259,14.42177],[53.30853,14.42438],[53.28224,14.43556],[53.27896,14.45028],[53.26018,14.45852],[53.2595,14.45867],[53.2189,14.41916],[53.20919,14.41332],[53.20568,14.40992],[53.19557,14.38822],[53.1643,14.38151],[53.14588,14.39742],[53.14562,14.39749],[53.04827,14.35989],[53.03146,14.32616],[52.98549,14.22813],[52.97135,14.1793],[52.95518,14.15209],[52.94373,14.15917],[52.93272,14.1573],[52.90097,14.17021],[52.88214,14.1742],[52.86883,14.1693],[52.85209,14.14617],[52.84332,14.1327],[52.83296,14.14575],[52.83086,14.16212],[52.83033,14.16317],[52.82722,14.19051],[52.82373,14.21769],[52.76656,14.31225],[52.75281,14.36309],[52.68275,14.44839],[52.67235,14.46853],[52.65942,14.47787],[52.63904,14.5421],[52.60747,14.61005],[52.57506,14.64806],[52.56837,14.65434],[52.5269,14.62299],[52.52054,14.61805],[52.52049,14.61815],[52.51933,14.61727],[52.49693,14.652],[52.43059,14.58605],[52.42273,14.55463],[52.41025,14.55299],[52.40951,14.55144],[52.40699,14.55257],[52.39495,14.55099],[52.34623,14.57981],[52.30829,14.59682],[52.28483,14.60039],[52.27555,14.64619],[52.26275,14.70427],[52.22906,14.72857],[52.1071,14.70984],[52.09762,14.74099],[52.06171,14.77307],[52.05944,14.77481],[52.00424,14.72869],[51.99795,14.72844],[51.9975,14.72809],[51.95713,14.72681],[51.91376,14.72507],[51.83235,14.60713],[51.83035,14.61182],[51.82766,14.60812],[51.80085,14.65952],[51.74483,14.67236],[51.73953,14.68006],[51.73411,14.68176],[51.69769,14.74087],[51.68793,14.75505],[51.6153,14.77871],[51.61427,14.7777],[51.58065,14.74431],[51.57814,14.70138],[51.54666,14.6768],[51.53708,14.60047],[51.5599,14.57992],[51.5421,14.52708],[51.53069,14.45223],[51.51288,14.36783],[51.49552,14.36013],[51.49552,14.32343],[51.5106,14.32196],[51.53297,14.17189],[51.51311,14.16491],[51.51356,14.13446],[51.47313,14.1196],[51.3681,14.02236],[51.37199,13.97466],[51.3894,13.97392],[51.37153,13.92108],[51.35252,13.77577],[51.36237,13.54919],[51.42808,13.42957],[51.3752,13.28609],[51.38768,13.22353],[51.42773,13.17436],[51.5404,13.1782],[51.59534,13.07596],[51.65302,13.02394],[51.71829,13.14162],[51.85316,13.10569],[51.86272,13.02518],[51.98572,12.66842],[51.96741,12.62506],[51.97198,12.508],[52.02918,12.33086],[52.1673,12.16859],[52.34398,12.25778],[52.4279,12.25034],[52.46263,12.28131],[52.50488,12.10789],[52.64039,12.14133],[52.65354,12.19088],[52.72562,12.15124],[52.81032,12.19584],[52.84325,12.1785],[52.82753,12.09426],[52.85971,12.06453],[52.85522,11.96667],[52.90008,11.7759],[52.93145,11.779],[53.04107,11.43711],[53.0135,11.33677],[53.09466,11.22404],[53.15041,11.25006],[53.16304,11.50772],[53.22909,11.50524],[53.27282,11.70096],[53.25503,11.75547],[53.32612,11.97348],[53.38859,12.01065],[53.37972,12.24972],[53.28578,12.5111],[53.27319,12.69939],[53.23205,12.8022],[53.215,13.01279],[53.2617,13.08835],[53.32168,13.44759],[53.4185,13.50952],[53.52541,13.72259],[53.5784,13.75851],[53.57546,13.82788],[53.51731,13.90964],[53.46056,13.9468],[53.44876,14.07191],[53.46498,14.11899],[53.45392,14.24782],[53.3764,14.26144],[53.29059,14.14624],[53.28689,14.23791],[53.33056,14.2986],[53.35626,14.41545]]}),angular.module("route360DemoApp").filter("reverse",function(){return function(a){return a.slice().reverse()}}).filter("secondsToHoursMin",function(){return function(a){return r360.Util.secondsToHoursAndMinutes(a)}}).filter("formatMeter",function(){return function(a){var b=a.toFixed(3);if(1e3>b)return 10*Math.round(b/10)+"m";var c=10*Math.round(b/10);return c/1e3+"km"}}).filter("secToHoursMin",function(){return function(a){var b=(a/60).toFixed(0),c=Math.floor(b/60);b-=60*c;var d="";return 0!=c&&(d+=c+" Std. "),0!=b&&(d+=b+" Min."),d}}).filter("cleanName",function(){return function(a){return a=a.trim().replace("(Berlin)",""),a=a.trim().replace("(Bln)",""),a=a.trim().replace(/\[.*\]$/g,""),a=a.trim().replace(/U{0-9}{1,2}$/g,"")}}).filter("secToMin",function(){return function(a){return Math.floor(a/60)}}).filter("secToTime",function(){return function(a){var b=(a/60).toFixed(0),c=Math.floor(b/60);b-=60*c;var d="";return d+=0!=c?c+":":"00:",0==b?b="00":10>b&&(b="0"+b),d+=b+" Uhr"}}).filter("formatKilometer",function(){return function(a){var b=1e3*a.toFixed(3);if(1e3>b)return 10*Math.round(b/10)+"m";var c=10*Math.round(b/10);return c/1e3+"km"}}).filter("prettifyNumber",function(){return function(a,b){var c=parseFloat(a),d=c.toFixed(2).toString().replace(".",",").replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1.");return null!=b&&""!=b&&(d+=" "+b),d}}).filter("truncate",function(){return function(a,b,c){return isNaN(b)&&(b=10),void 0===c&&(c="..."),a.length<=b||a.length-c.length<=b?a:String(a).substring(0,b-c.length)+c}}),angular.module("route360DemoApp").factory("TableParamFactory",["$filter","$timeout","ngTableParams",function(a,b,c){return{create:function(d){var e=new c({page:1,count:10,sorting:{travelTime:"asc"}},{counts:[],total:d.length,getData:function(c,e){b(function(){var b=d,f=e.sorting()?a("orderBy")(b,e.orderBy()):b;c.resolve(f.slice((e.page()-1)*e.count(),e.page()*e.count()))},400)},$scope:{$data:{}}});return e}}}]);