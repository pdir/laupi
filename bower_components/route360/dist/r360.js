/*
 Route360° JavaScript API v0.0.9 (9ec6272), a JS library for leaflet maps. http://route360.net
 (c) 2014 Henning Hollburg and Daniel Gerber, (c) 2014 Motion Intelligence GmbH
*/
!function(e,t,n){function o(){var t=e.r360;r.noConflict=function(){return e.r360=t,this},e.r360=r}var r={version:"v0.0.9"};"object"==typeof module&&"object"==typeof module.exports?module.exports=r:"function"==typeof define&&define.amd?define(r):o(),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,i=function(){},o=function(){return n.apply(this instanceof i&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,o.prototype=new i,o}),r.config={serviceUrl:"https://api.route360.net/api_dev/",nominatimUrl:"https://geocode.route360.net/",osmServiceUrl:"https://api.route360.net/r360-osm-api-norway/",serviceVersion:"v1",pathSerializer:"compact",requestTimeout:1e4,maxRoutingTime:3600,bikeSpeed:15,bikeUphill:20,bikeDownhill:-10,walkSpeed:5,walkUphill:10,walkDownhill:0,travelTimes:[300,600,900,1200,1500,1800],travelType:"walk",logging:!1,defaultTravelTimeControlOptions:{travelTimes:[{time:300,color:"#006837",opacity:.1},{time:600,color:"#39B54A",opacity:.2},{time:900,color:"#8CC63F",opacity:.3},{time:1200,color:"#F7931E",opacity:.4},{time:1500,color:"#F15A24",opacity:.5},{time:1800,color:"#C1272D",opacity:1}],position:"topright",label:"travel time",initValue:30},routeTypes:[{routeType:"WALK",color:"red",haloColor:"white"},{routeType:"BIKE",color:"#558D54",haloColor:"white"},{routeType:"CAR",color:"#558D54",haloColor:"white"},{routeType:"TRANSFER",color:"#C1272D",haloColor:"white"},{routeType:102,color:"#006837",haloColor:"white"},{routeType:400,color:"#156ab8",haloColor:"white"},{routeType:900,color:"red",haloColor:"white"},{routeType:700,color:"#A3007C",haloColor:"white"},{routeType:1e3,color:"blue",haloColor:"white"},{routeType:109,color:"#006F35",haloColor:"white"},{routeType:100,color:"red",haloColor:"white"},{routeType:1,color:"red",haloColor:"red"},{routeType:2,color:"blue",haloColor:"blue"},{routeType:3,color:"yellow",haloColor:"yellow"},{routeType:0,color:"green",haloColor:"green"},{routeType:4,color:"orange",haloColor:"orange"},{routeType:5,color:"red",haloColor:"red"},{routeType:6,color:"blue",haloColor:"blue"},{routeType:7,color:"yellow",haloColor:"yellow"}],defaultPlaceAutoCompleteOptions:{serviceUrl:"https://geocode.route360.net/solr/select?",position:"topleft",reset:!1,reverse:!1,autoHide:!0,placeholder:"Select source",maxRows:5,width:300},photonPlaceAutoCompleteOptions:{serviceUrl:"https://geocode2.route360.net/photon/api?",position:"topleft",reset:!1,reverse:!1,placeholder:"Select source",maxRows:5,width:300},defaultRadioOptions:{position:"topright"},defaultPolygonLayerOptions:{opacity:.4,strokeWidth:30,tolerance:15,backgroundColor:"black",backgroundOpacity:.5,inverse:!1,animate:!1,animationDuration:1},i18n:{language:"en",configuredLanguages:["en","de","no"],info:{en:"More information",de:"Mehr informationen",no:"Mer Informasjon"},fullscreen:{en:"Fullscreen",de:"Vollbild",no:"Fullskjerm"},slow:{en:"Slow",de:"Langsam",no:"Sakte"},low:{en:"Low",de:"Gering",no:"Lav"},medium:{en:"Medium",de:"Mittel",no:"Medium"},fast:{en:"Fast",de:"Schnell",no:"Raskt"},high:{en:"High",de:"Hoch",no:"Høy"},departure:{en:"Departure",de:"Abfahrt",no:"TODO TRANSLATION: "},placeholderSrc:{en:"Select source!",de:"Start wählen!",no:"Start"},placeholderTrg:{en:"Select target!",de:"Ziel wählen!",no:"Mål"},line:{en:"Line",de:"Linie",no:"TODO TRANSLATION: "},arrival:{en:"Arrival",de:"Ankunft",no:"TODO TRANSLATION: "},from:{en:"From",de:"Von",no:"TODO TRANSLATION: "},to:{en:"To",de:"Nach",no:"TODO TRANSLATION: "},travelTime:{en:"Travel time",de:"Reisezeit",no:"Reisetid"},totalTime:{en:"Total time",de:"Gesamtzeit",no:"TODO TRANSLATION: "},batteryCapacity:{en:"Battery capacity",de:"Akkuleistung",no:"Batterikapasitet"},distance:{en:"Distance",de:"Distanz",no:"Avstand"},wait:{en:"Please wait!",de:"Bitte warten!",no:"Vennligst vent!"},polygonWait:{en:"Calculating reachable area!",de:"Berechne erreichbare Fläche!",no:"Vennligst vent!"},routeWait:{en:"Searching route to target(s)!",de:"Suche Route zum Ziel!",no:"Vennligst vent!"},timeWait:{en:"Getting travel times to target(s)!",de:"Berechne Reisezeiten für Ziele!",no:"Vennligst vent!"},osmWait:{en:"Searching for points of interests!",de:"Suche nach Sehenswürdigkeiten!",no:"Vennligst vent!"},populationWait:{en:"Calculating population statistics!",de:"Berechne Bevölkerungsstatistik!",no:"Vennligst vent!"},elevation:{en:"Elevation",de:"Höhenunterschied",no:"Stigning"},timeFormat:{en:"a.m.",de:"Uhr",no:"TODO_TRANSLATION"},reset:{en:"Reset input",de:"Eingeben löschen",no:"Reset"},reverse:{en:"Switch source and target",de:"Start und Ziel tauschen",no:"Motsatt"},settings:{en:"Switch travel type",de:"Reisemodus wechseln",no:"Reisemåte"},noRouteFound:{en:"No route found!",de:"Keine Route gefunden!",no:"TODO TRANSLATION"},monthNames:{en:["January","February","March","April","May","June","July","August","September","October","November","December"],de:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],no:["TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION"]},dayNames:{en:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],de:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],no:["TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION"]},dayNamesMin:{en:["Su","Mo","Tu","We","Th","Fr","Sa"],de:["So","Mo","Di","Mi","Do","Fr","Sa"],no:["TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION"]},museum:{en:"Museum",de:"Museum",no:"Museum"},swimming_pool:{en:"Swimming pool",de:"Schwimmbad",no:"Svømmebassenger"},restaurant:{en:"Restaurant",de:"Restaurant",no:"Restaurant"},cinema:{en:"Cinema",de:"Kino",no:"Kino"},theater:{en:"Theater",de:"Theater",no:"Teater"},library:{en:"Library",de:"Bibliothek",no:"Bibliotek"},bike_rental_station:{en:"Bike rental station",de:"Fahrradleihstation",no:"TODO TRANSLATION"},cycling_speed_help:{en:"Cycling speed: {}km/h",de:"Fahrradgeschwindigkeit: {}km/h",no:"G Fart: {}km/h, Fart: {}km/h"},walking_speed_help:{en:"Walk speed: {}km/h",de:"Laufgeschwindigkeit: {}km/h",no:"Fart: {}km/h"},walking_and_cycling_speed_help:{en:"Walk speed: {}km/h, Cycling speed: {}km/h",de:"Laufgeschwindigkeit: {}km/h, Fahrradgeschwindigkeit: {}km/h",no:"Fart: {}km/h (Gå), Fart: {}km/h (Sykle)"},ebike_speed_help_fast:{en:"Little support from the pedelec",de:"Keine Unterstützung durch das Pedelec",no:"Høy egeninnsats - Lav motorinnsats"},ebike_speed_help_medium:{en:"Medium support from the pedelec",de:"Mittlere Unterstützung durch das Pedelec",no:"Medium egeninnsats - Medium motorinnsats"},ebike_speed_help_slow:{en:"Full support from the pedelec",de:"Volle Unterstützung durch das Pedelec",no:"Lav egeninnsats - Høy motorinnsats"},contribution:{en:"Personal contribution",de:"Eigenleistung",no:"Egeninnsats"},low_contribution:{en:"Low personal contribution",de:"Geringe Eigenleistung",no:"Lav Egeninnsats"},switchLanguage:function(){var e=[];_.each(r.config.i18n.configuredLanguages,function(t){e.push("[lang='"+t+"']")}),$(e.join(", ")).hide(),$("[lang='"+r.config.i18n.language+"']").show()},getSpan:function(e){var t="";return _.each(_.keys(r.config.i18n[e]),function(n){t+='<span lang="'+n+'">'+r.config.i18n[e][n]+"</span>"}),t},getSpan:function(e,t){var n="";return _.each(_.keys(r.config.i18n[e]),function(i){var o=r.config.i18n[e][i];_.each(t,function(e){o=o.replace("{}",e)}),n+='<span lang="'+i+'">'+o+"</span>"}),""==n?"_"+e+"_":n},get:function(e){var t;return _.each(_.keys(r.config.i18n),function(n){e==n&&(t=r.config.i18n[e][r.config.i18n.language])}),t}}},r.PolygonUtil={clip:function(e,t){var n,o,r,a,l=function(e){return(o[0]-n[0])*(e[1]-n[1])>(o[1]-n[1])*(e[0]-n[0])},s=function(){var e=[n[0]-o[0],n[1]-o[1]],t=[r[0]-a[0],r[1]-a[1]],i=n[0]*o[1]-n[1]*o[0],l=r[0]*a[1]-r[1]*a[0],s=1/(e[0]*t[1]-e[1]*t[0]);return[(i*t[0]-l*e[0])*s,(i*t[1]-l*e[1])*s]},g=e,n=t[t.length-1];for(j in t){var o=t[j],h=g;g=[],r=h[h.length-1];for(i in h){var a=h[i];l(a)?(l(r)||g.push(s()),g.push(a)):l(r)&&g.push(s()),r=a}n=o}return g},isCollinear:function(e,t,n){if(e.x==n.x&&e.y==n.y)return!1;if(e.x==t.x&&t.x==n.x)return!0;if(e.y==t.y&&t.y==n.y)return!0;var i=e.x*(t.y-n.y)+t.x*(n.y-e.y)+n.x*(e.y-t.y);return i<r.config.defaultPolygonLayerOptions.tolerance&&i>-r.config.defaultPolygonLayerOptions.tolerance&&e.x!=n.x&&e.y!=n.y?!0:!1},scale:function(e,t){return e.x*=t,e.y*=t,e},subtract:function(e,t,n){return e.x-=t,e.y-=n,e},divide:function(e,t){return e.x/=t,e.y/=t,e},roundPoint:function(e){return e.x=Math.round(e.x),e.y=Math.round(e.y),e},buildPath:function(e,t){return[t,Math.round(e.x),Math.round(e.y)]},getEuclidianDistance:function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},getSvgFrame:function(e,t){return[["M",0,0],["L",e,0],["L",e,t],["L",0,t],["z"]]},extendBounds:function(e,t,n){var i=Math.ceil(t),o=Math.ceil(n);return e.max.x+=i,e.min.x-=i,e.max.y+=o,e.min.y-=o,e},prepareMultipolygons:function(e,t,n){for(var i=[],o=0;o<e.length;o++)for(var a=0;a<e[o].polygons.length;a++){var l=e[o].polygons[a];l.project(),r.PolygonUtil.updateBoundingBox(l,t,n),r.PolygonUtil.addPolygonToMultiPolygon(i,l)}return i.sort(function(e,t){return t.getTravelTime()-e.getTravelTime()}),i},updateBoundingBox:function(e,t,n){e.topRight.lat>t.lat&&(t.lat=e.topRight.lat),e.topRight.lng>t.lng&&(t.lng=e.topRight.lng),e.bottomLeft.lat<n.lat&&(n.lat=e.bottomLeft.lat),e.bottomLeft.lng<n.lng&&(n.lng=e.bottomLeft.lng)},addPolygonToMultiPolygon:function(e,t){var n=_.filter(e,function(e){return e.getTravelTime()==t.travelTime});if(n.length>0)n[0].addPolygon(t);else{var i=new r.multiPolygon;i.setTravelTime(t.travelTime),i.addPolygon(t),i.setColor(t.getColor()),i.setOpacity(t.getOpacity()),e.push(i)}}},r.SvgUtil={getGElement:function(e,t){var n=r.Util.generateId(),i=t.opacity;return"<g id="+n+" style='opacity:"+i+"'><path style='stroke: "+t.color+"; fill: "+t.color+" ; stroke-opacity: 1; stroke-width: "+t.strokeWidth+"; fill-opacity:1'd='"+e.toString().replace(/\,/g," ")+"'/></g>"},getInverseSvgElement:function(e,t){var n=r.PolygonUtil.getSvgFrame(t.svgWidth,t.svgHeight),i="<div id=svg_"+t.id+" style='"+r.Util.getTranslation(t.offset)+";''><svg height="+t.svgHeight+" width="+t.svgWidth+" style='fill:"+t.backgroundColor+" ; opacity: "+t.backgroundOpacity+"; stroke-width: "+t.strokeWidth+"; stroke-linejoin:round; stroke-linecap:round; fill-rule: evenodd' xmlns='http://www.w3.org/2000/svg'>",o="</svg></div>",a="<defs><mask id='mask_"+t.id+"'><path style='fill-opacity:1;stroke: white; fill:white;' d='"+n.toString().replace(/\,/g," ")+"'/>"+e.join("")+"</mask></defs>",l="<path style='mask: url(#mask_"+t.id+")' d='"+n.toString().replace(/\,/g," ")+"'/>";return i+l+a+o},getNormalSvgElement:function(e,t){var n="<div id=svg_"+t.id+" style='"+r.Util.getTranslation(t.offset)+";''><svg  height="+t.svgHeight+" width="+t.svgWidth+" style='fill:"+t.backgroundColor+" ; opacity: "+t.opacity+"; stroke-linejoin:round; stroke-linecap:round; fill-rule: evenodd' xmlns='http://www.w3.org/2000/svg'>",i="</svg></div>";return n+e.join("")+i},createSvgData:function(e,t){var n=[],i=e.getProjectedTopRight(),o=e.getProjectedBottomLeft();r.PolygonUtil.scale(i,t.scale),r.PolygonUtil.scale(o,t.scale),o.x>t.bounds.max.x||i.x<t.bounds.min.x||i.y>t.bounds.max.y||o.y<t.bounds.min.y||r.SvgUtil.buildSVGPolygon(n,e.outerProjectedBoundary,t);for(var a=0;a<e.innerProjectedBoundaries.length;a++){var i=e.innerProjectedBoundaries[a].getProjectedTopRight(),o=e.innerProjectedBoundaries[a].getProjectedBottomLeft();r.PolygonUtil.scale(i,t.scale),r.PolygonUtil.scale(o,t.scale),o.x>t.bounds.max.x||i.x<t.bounds.min.x||i.y>t.bounds.max.y||o.y<t.bounds.min.y||r.SvgUtil.buildSVGPolygon(n,e.innerProjectedBoundaries[a].points,t)}return n},buildSVGPolygon:function(e,t,n){for(var i,o,a,l,s,g,h=0,u=[[n.bounds.min.x,n.bounds.min.y],[n.bounds.max.x,n.bounds.min.y],[n.bounds.max.x,n.bounds.max.y],[n.bounds.min.x,n.bounds.max.y]],d=[],c=0;c<t.length;c++)i=t[c],o=new L.Point(i.x,i.y),r.PolygonUtil.scale(o,n.scale),r.PolygonUtil.roundPoint(o),g=c>0?r.PolygonUtil.getEuclidianDistance(l,o):n.tolerance,g>=n.tolerance&&(s=!1,h>2&&(s=r.PolygonUtil.isCollinear(a,l,o)),s?(d[d.length-1][0]=o.x,d[d.length-1][1]=o.y):(d.push([o.x,o.y]),a=l,l=o,h++));for(var p,f=r.PolygonUtil.clip(d,u),c=0;c<f.length;c++)o=new L.Point(f[c][0],f[c][1]),r.PolygonUtil.subtract(o,n.pixelOrigin.x+n.offset.x,n.pixelOrigin.y+n.offset.y),e.push(c>0?r.PolygonUtil.buildPath(o,"L"):r.PolygonUtil.buildPath(o,"M")),p=o;return e.length>0&&e.push(["z"]),e}},r.Util={getTimeInSeconds:function(){var e=new Date;return 3600*e.getHours()+60*e.getMinutes()+e.getSeconds()},getHoursAndMinutesInSeconds:function(){var e=new Date;return 3600*e.getHours()+60*e.getMinutes()},getCurrentDate:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,i=e.getDate()<10?"0"+e.getDate():e.getDate();return t+""+n+i},getTimeFormat:function(e){var t=r.config.i18n;return"en"==t.language&&e>=43200?"p.m.":t.get("timeFormat")},secondsToHoursAndMinutes:function(e){var t=(e/60).toFixed(0),n=Math.floor(t/60);t-=60*n;var i="";return 0!=n&&(i+=n+"h "),i+=t+"min"},secondsToTimeOfDay:function(e){var t=Math.floor(e/3600),n=Math.floor(e/60)-60*t;return e=e-3600*t-60*n,t+":"+("0"+n).slice(-2)+":"+("0"+e).slice(-2)},generateId:function(e){var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";return _.each(_.range(e?e:10),function(){t+=n.charAt(Math.floor(Math.random()*n.length))}),t},parseLatLonArray:function(e){for(var t=new Array,n=0;n<e.length;n++)t.push(new L.Point(e[n][0],e[n][1]));return t},routeToLeafletPolylines:function(e,t){t="undefined"!=typeof t?t:{};var n=[];return _.each(e.getSegments(),function(i,o){if("TRANSFER"!=i.getType()){var r={};r.color=_.has(t,"color")?t.color:i.getColor();var a={};a.weight=7,a.color="white",(0==o||o==e.getLength()-1)&&(r.dashArray="1, 8");var l=L.polyline(i.getPoints(),a),s=L.polyline(i.getPoints(),r);n.push([l,s])}}),n},getAddressByCoordinates:function(e,t,n){$.getJSON(r.config.nominatimUrl+"reverse.php?&format=json&lat="+e.lat+"&accept-language="+t+"&lon="+e.lng+"&json_callback=?",n)},formatReverseGeocoding:function(e){var t=[];_.has(e.address,"road")&&t.push(e.address.road),_.has(e.address,"house_number")&&t.push(e.address.house_number);var n=[];_.has(e.address,"postcode")&&n.push(e.address.postcode),_.has(e.address,"city")&&n.push(e.address.city);var i=[];return t.length>0&&i.push(t.join(" ")),n.length>0&&i.push(n.join(", ")),0==t.length&&0==n.length&&i.push(e.display_name),i.join(", ")},parsePolygons:function(e){if(e.error)return errorMessage;if(r.config.logging)var t=(new Date).getTime();var n=[];return _.each(e,function(e){var t={id:e.id,polygons:[]};_.each(e.polygons,function(e){var n=r.polygon(e.travelTime,e.area,r.Util.parseLatLonArray(e.outerBoundary)),i=_.findWhere(r.config.defaultTravelTimeControlOptions.travelTimes,{time:n.getTravelTime()});n.setColor(_.isUndefined(i)?"#000000":i.color);var o=_.findWhere(r.config.defaultTravelTimeControlOptions.travelTimes,{time:n.getTravelTime()});n.setOpacity(_.isUndefined(o)?1:o.opacity),_.each(e.innerBoundary,function(e){n.addInnerBoundary(r.Util.parseLatLonArray(e))}),t.polygons.push(n)}),n.push(t)}),r.config.logging&&console.log("Polygon parsing took: "+((new Date).getTime()-t)+"ms"),n},parseRoutes:function(e){for(var t=new Array,n=0;n<e.routes.length;n++)t.push(r.route(e.routes[n].travelTime,e.routes[n].segments));return t},getMarker:function(e,t){var n=_.has(t,"color")?"-"+t.color:"-blue";return t.icon=L.icon({iconSize:[25,41],iconUrl:t.iconPath+"marker-icon"+n+".png",iconAnchor:[12,41],shadowSize:[41,41],shadowUrl:t.iconPath+"marker-shadow.png",shadowAnchor:[41/3,41],popupAnchor:[0,-35]}),L.marker(e,t)},webMercatorToLeaflet:function(e){return e.x/=6378137,e.y/=6378137,L.CRS.EPSG3857.transformation._transform(e),e},webMercatorToLatLng:function(e,t){var n=L.CRS.EPSG3857.projection.unproject(new L.Point(e.x/=6378137,e.y/=6378137));return"undefined"!=typeof t?L.latLng([n.lat,n.lng,t]):n},latLngToWebMercator:function(e){var t=L.Projection.SphericalMercator.project(e);return t.x*=6378137,t.y*=6378137,t},getUserAgent:function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE "+(e[1]||"")):"Chrome"===n[1]&&(e=t.match(/\bOPR\/(\d+)/),null!=e)?"Opera "+e[1]:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))},isAnimated:function(){var e=getUserAgent();return-1!=e.indexOf("IE")?!1:-1!=e.indexOf("Safari")?!1:-1!=e.indexOf("Firefox")?!1:r.config.defaultPolygonLayerOptions.animate?!0:!1},getTranslation:function(e){var t=r.Util.getUserAgent();return-1!=t.indexOf("IE 9")?"transform:translate("+e.x+"px,"+e.y+"px)":-1!=t.indexOf("Safari")?"-webkit-transform:translate3d("+e.x+"px,"+e.y+"px,0px)":-1!=t.indexOf("Firefox")?"-moz-transform:translate3d("+e.x+"px,"+e.y+"px,0px)":"transform:translate3d("+e.x+"px,"+e.y+"px,0px)"},formatNum:function(e,t){var n=Math.pow(10,t||5);return Math.round(e*n)/n},isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},googleLatlngToPoint:function(e,t,n){var i=e.getProjection().fromLatLngToPoint(t),o=Math.pow(2,n);return new google.maps.Point(i.x*o,i.y*o)},googlePointToLatlng:function(e,t,n){var i=Math.pow(2,n),o=new google.maps.Point(t.x/i,t.y/i),r=e.getProjection().fromPointToLatLng(o);return r}},r.DomUtil={setPosition:function(e,t){e._leaflet_pos=t,L.Browser.any3d?r.DomUtil.setTransform(e,t):(e.style.left=t.x+"px",e.style.top=t.y+"px")},setTransform:function(e,t,n){var i=t||new L.Point(0,0);e.style[r.DomUtil.TRANSFORM]="translate3d("+i.x+"px,"+i.y+"px,0)"+(n?" scale("+n+")":"")},testProp:function(e){for(var n=t.documentElement.style,i=0;i<e.length;i++)if(e[i]in n)return e[i];return!1}},function(){r.DomUtil.TRANSFORM=r.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"])}(),r.TravelOptions=function(){this.sources=[],this.targets=[],this.service,this.bikeSpeed=n,this.bikeUphill=n,this.bikeDownhill=n,this.walkSpeed=n,this.walkUphill=n,this.walkDownhill=n,this.supportWatts=n,this.renderWatts=n,this.travelTimes=n,this.travelType=n,this.elevationEnabled=n,this.minPolygonHoleSize=n,this.time=n,this.date=n,this.recommendations=n,this.errors=[],this.intersectionMode=n,this.pathSerializer=r.config.pathSerializer,this.maxRoutingTime=n,this.waitControl,this.isValidPolygonServiceOptions=function(e){return this.errors=[],"[object Array]"===Object.prototype.toString.call(this.getSources())?0==this.getSources().length?this.getErrors().push("Sources do not contain any points!"):_.each(this.getSources(),function(e){_.has(e,"lat")||"function"==typeof e.getLatLng||this.getErrors().push("Sources contains source with undefined latitude!"),_.has(e,"lon")||_.has(e,"lng")||"function"==typeof e.getLatLng||this.getErrors().push("Sources contains source with undefined longitude!")}):this.getErrors().push("Sources are not of type array!"),_.contains(["bike","transit","walk","car","rentbike","rentandreturnbike","ebike"],this.getTravelType())?"car"==this.getTravelType()||("bike"==this.getTravelType()||"rentbike"==this.getTravelType()||"rentandreturnbike"==this.getTravelType()?(""!=typeof this.getBikeUphill()&&""!=typeof this.getBikeDownhill()&&"undefined"!=typeof this.getBikeUphill()&&(this.getBikeUphill()<0||this.getBikeDownhill()>0||this.getBikeUphill()<-this.getBikeDownhill())&&this.getErrors().push("Uphill cycle speed has to be larger then 0. Downhill cycle speed has to be smaller then 0.                             Absolute value of downhill cycle speed needs to be smaller then uphill cycle speed."),this.getBikeSpeed()<=0&&this.getErrors().push("Bike speed needs to be larger then 0.")):"walk"==this.getTravelType()?(""!=typeof this.getBikeUphill()&&""!=typeof this.getBikeDownhill()&&"undefined"!=typeof this.getBikeUphill()&&(this.getWalkUphill()<0||this.getWalkDownhill()>0||this.getWalkUphill()<-this.getWalkDownhill())&&this.getErrors().push("Uphill walking speed has to be larger then 0. Downhill walking speed has to be smaller then 0.                             Absolute value of downhill walking speed needs to be smaller then uphill walking speed."),this.getWalkSpeed()<=0&&this.getErrors().push("Walk speed needs to be larger then 0.")):"transit"==this.getTravelType()):this.getErrors().push("Not supported travel type given: "+this.getTravelType()),e||("undefined"==typeof this.getTravelTimes()||"[object Array]"!==Object.prototype.toString.call(this.getTravelTimes())?this.getErrors().push("Travel times have to be an array!"):_.reject(this.getTravelTimes(),function(e){return"number"==typeof e}).length>0&&this.getErrors().push("Travel times contain non number entries: "+this.getTravelTimes())),0==this.errors.length},this.isValidRouteServiceOptions=function(){return this.isValidPolygonServiceOptions(!0),"[object Array]"===Object.prototype.toString.call(this.getTargets())?0==this.getTargets().length?this.getErrors().push("Sources do not contain any points!"):_.each(this.getTargets(),function(e){_.has(e,"lat")||"function"==typeof e.getLatLng||this.getErrors().push("Targets contains target with undefined latitude!"),_.has(e,"lon")||_.has(e,"lng")||"function"==typeof e.getLatLng||this.getErrors().push("Targets contains target with undefined longitude!")}):this.getErrors().push("Targets are not of type array!"),_.contains(["travelTime","compact","detailed"],this.getPathSerializer())||this.getErrors().push("Path serializer not supported: "+this.getPathSerializer()),0==this.errors.length},this.isValidTimeServiceOptions=function(){return this.isValidRouteServiceOptions(),_.contains(["travelTime","compact","detailed"],this.getPathSerializer())||this.getErrors().push("Path serializer not supported: "+this.getPathSerializer()),0==this.errors.length},this.getErrors=function(){return this.errors},this.getSources=function(){return this.sources},this.addSource=function(e){this.sources.push(e)},this.addTarget=function(e){this.targets.push(e)},this.getTargets=function(){return this.targets},this.getBikeSpeed=function(){return this.bikeSpeed},this.getBikeUphill=function(){return this.bikeUphill},this.getBikeDownhill=function(){return this.bikeDownhill},this.getWalkSpeed=function(){return this.walkSpeed},this.getWalkUphill=function(){return this.walkUphill},this.getWalkDownhill=function(){return this.walkDownhill},this.getTravelTimes=function(){return this.travelTimes},this.getTravelType=function(){return this.travelType},this.getTime=function(){return this.time},this.getDate=function(){return this.date},this.getWaitControl=function(){return this.waitControl},this.getService=function(){return this.service},this.getPathSerializer=function(){return this.pathSerializer},this.getMaxRoutingTime=function(){return this.maxRoutingTime},this.getIntersectionMode=function(){return this.intersectionMode},this.getRecommendations=function(){return this.recommendations},this.setRecommendations=function(e){this.recommendations=e},this.setIntersectionMode=function(e){this.intersectionMode=e},this.setMaxRoutingTime=function(e){this.maxRoutingTime=e},this.setPathSerializer=function(e){this.pathSerializer=e},this.setService=function(e){this.service=e},this.setMinPolygonHoleSize=function(e){this.minPolygonHoleSize=e},this.getMinPolygonHoleSize=function(){return this.minPolygonHoleSize},this.setSources=function(e){this.sources=e},this.setTargets=function(e){this.targets=e},this.setBikeSpeed=function(e){this.bikeSpeed=e},this.setBikeUphill=function(e){this.bikeUphill=e},this.setBikeDownhill=function(e){this.bikeDownhill=e},this.setWalkSpeed=function(e){this.walkSpeed=e},this.setWalkUphill=function(e){this.walkUphill=e},this.setWalkDownhill=function(e){this.walkDownhill=e},this.setTravelTimes=function(e){this.travelTimes=e},this.setTravelType=function(e){this.travelType=e},this.setTime=function(e){this.time=e},this.setDate=function(e){this.date=e},this.setWaitControl=function(e){this.waitControl=e},this.isElevationEnabled=function(){return this.elevationEnabled},this.setElevationEnabled=function(e){this.elevationEnabled=e},this.setRenderWatts=function(e){this.renderWatts=e},this.getRenderWatts=function(){return this.renderWatts},this.setSupportWatts=function(e){this.supportWatts=e},this.getSupportWatts=function(){return this.supportWatts}},r.travelOptions=function(){return new r.TravelOptions},r.PolygonService={cache:{},getTravelTimePolygons:function(e,t,n){e.getWaitControl()&&(e.getWaitControl().show(),e.getWaitControl().updateText(r.config.i18n.getSpan("polygonWait")));var i={};i.sources=[],_.isUndefined(e.isElevationEnabled())||(i.elevation=e.isElevationEnabled()),_.isUndefined(e.getTravelTimes())&&_.isUndefined(e.getIntersectionMode())&&_.isUndefined(e.getRenderWatts())&&_.isUndefined(e.getSupportWatts())||(i.polygon={},_.isUndefined(e.getTravelTimes())||(i.polygon.values=e.getTravelTimes()),_.isUndefined(e.getIntersectionMode())||(i.polygon.intersectionMode=e.getIntersectionMode()),_.isUndefined(e.getRenderWatts())||(i.polygon.renderWatts=e.getRenderWatts()),_.isUndefined(e.getSupportWatts())||(i.polygon.supportWatts=e.getSupportWatts()),_.isUndefined(e.getMinPolygonHoleSize())||(i.polygon.minPolygonHoleSize=e.getMinPolygonHoleSize())),_.each(e.getSources(),function(t){var n={lat:_.has(t,"lat")?t.lat:t.getLatLng().lat,lng:_.has(t,"lon")?t.lon:_.has(t,"lng")?t.lng:t.getLatLng().lng,id:_.has(t,"id")?t.id:"",tm:{}},o=_.has(t,"travelType")?t.travelType:e.getTravelType();n.tm[o]={},("transit"==o||"biketransit"==o)&&(n.tm[o].frame={},_.isUndefined(e.getTime())||(n.tm[o].frame.time=e.getTime()),_.isUndefined(e.getDate())||(n.tm[o].frame.date=e.getDate())),"ebike"==o&&(n.tm.ebike={},_.isUndefined(e.getBikeSpeed())||(n.tm.ebike.speed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.ebike.uphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.ebike.downhill=e.getBikeDownhill())),"rentbike"==o&&(n.tm.rentbike={},_.isUndefined(e.getBikeSpeed())||(n.tm.rentbike.bikespeed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.rentbike.bikeuphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.rentbike.bikedownhill=e.getBikeDownhill()),_.isUndefined(e.getWalkSpeed())||(n.tm.rentbike.walkspeed=e.getWalkSpeed()),_.isUndefined(e.getWalkUphill())||(n.tm.rentbike.walkuphill=e.getWalkUphill()),_.isUndefined(e.getWalkDownhill())||(n.tm.rentbike.walkdownhill=e.getWalkDownhill())),"rentandreturnbike"==o&&(n.tm.rentandreturnbike={},_.isUndefined(e.getBikeSpeed())||(n.tm.rentandreturnbike.bikespeed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.rentandreturnbike.bikeuphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.rentandreturnbike.bikedownhill=e.getBikeDownhill()),_.isUndefined(e.getWalkSpeed())||(n.tm.rentandreturnbike.walkspeed=e.getWalkSpeed()),_.isUndefined(e.getWalkUphill())||(n.tm.rentandreturnbike.walkuphill=e.getWalkUphill()),_.isUndefined(e.getWalkDownhill())||(n.tm.rentandreturnbike.walkdownhill=e.getWalkDownhill())),"bike"==o&&(n.tm.bike={},_.isUndefined(e.getBikeSpeed())||(n.tm.bike.speed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.bike.uphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.bike.downhill=e.getBikeDownhill())),"walk"==o&&(n.tm.walk={},_.isUndefined(e.getWalkSpeed())||(n.tm.walk.speed=e.getWalkSpeed()),_.isUndefined(e.getWalkUphill())||(n.tm.walk.uphill=e.getWalkUphill()),_.isUndefined(e.getWalkDownhill())||(n.tm.walk.downhill=e.getWalkDownhill())),i.sources.push(n)}),_.has(r.PolygonService.cache,JSON.stringify(i))?(e.getWaitControl()&&e.getWaitControl().hide(),t(r.Util.parsePolygons(r.PolygonService.cache[JSON.stringify(i)]))):$.ajax({url:r.config.serviceUrl+r.config.serviceVersion+"/polygon?cfg="+encodeURIComponent(JSON.stringify(i))+"&cb=?&key="+r.config.serviceKey,timeout:r.config.requestTimeout,dataType:"json",success:function(o){e.getWaitControl()&&e.getWaitControl().hide(),_.has(o,"data")?"ok"==o.code?(r.PolygonService.cache[JSON.stringify(i)]=o.data,t(r.Util.parsePolygons(o.data))):_.isFunction(n)&&n(o.code,o.message):(r.PolygonService.cache[JSON.stringify(i)]=o,t(r.Util.parsePolygons(o)))},error:function(){e.getWaitControl()&&e.getWaitControl().hide(),_.isFunction(n)&&n("service-not-available","The travel time polygon service is currently not available, please try again later.")}})}},r.PopulationService={cache:{},getPopulationStatistics:function(e,t,n,i){e.getWaitControl()&&(e.getWaitControl().show(),e.getWaitControl().updateText(r.config.i18n.getSpan("populationWait")));var o={};o.sources=[],"undefined"!=typeof e.isElevationEnabled()&&(o.elevation=e.isElevationEnabled()),("undefined"!=typeof e.getTravelTimes()||"undefined"!=typeof e.getIntersectionMode()||"undefined"!=typeof e.getRenderWatts()||"undefined"!=typeof e.getSupportWatts())&&(o.polygon={},"undefined"!=typeof e.getTravelTimes()&&(o.polygon.values=e.getTravelTimes()),"undefined"!=typeof e.getIntersectionMode()&&(o.polygon.intersectionMode=e.getIntersectionMode()),"undefined"!=typeof e.getRenderWatts()&&(o.polygon.renderWatts=e.getRenderWatts()),"undefined"!=typeof e.getSupportWatts()&&(o.polygon.supportWatts=e.getSupportWatts())),_.each(e.getSources(),function(t){var n={lat:_.has(t,"lat")?t.lat:t.getLatLng().lat,lng:_.has(t,"lon")?t.lon:_.has(t,"lng")?t.lng:t.getLatLng().lng,id:_.has(t,"id")?t.id:t.lat+";"+t.lng,tm:{}},i=_.has(t,"travelType")?t.travelType:e.getTravelType();n.tm[i]={},"transit"==i&&(n.tm.transit.frame={},_.isUndefined(e.getTime())||(n.tm.transit.frame.time=e.getTime()),_.isUndefined(e.getDate())||(n.tm.transit.frame.date=e.getDate())),"ebike"==i&&(n.tm.ebike={},_.isUndefined(e.getBikeSpeed())||(n.tm.ebike.speed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.ebike.uphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.ebike.downhill=e.getBikeDownhill())),"rentbike"==i&&(n.tm.rentbike={},_.isUndefined(e.getBikeSpeed())||(n.tm.rentbike.bikespeed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.rentbike.bikeuphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.rentbike.bikedownhill=e.getBikeDownhill()),_.isUndefined(e.getWalkSpeed())||(n.tm.rentbike.walkspeed=e.getWalkSpeed()),_.isUndefined(e.getWalkUphill())||(n.tm.rentbike.walkuphill=e.getWalkUphill()),_.isUndefined(e.getWalkDownhill())||(n.tm.rentbike.walkdownhill=e.getWalkDownhill())),"rentandreturnbike"==i&&(n.tm.rentandreturnbike={},_.isUndefined(e.getBikeSpeed())||(n.tm.rentandreturnbike.bikespeed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.rentandreturnbike.bikeuphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.rentandreturnbike.bikedownhill=e.getBikeDownhill()),_.isUndefined(e.getWalkSpeed())||(n.tm.rentandreturnbike.walkspeed=e.getWalkSpeed()),_.isUndefined(e.getWalkUphill())||(n.tm.rentandreturnbike.walkuphill=e.getWalkUphill()),_.isUndefined(e.getWalkDownhill())||(n.tm.rentandreturnbike.walkdownhill=e.getWalkDownhill())),"bike"==i&&(n.tm.bike={},_.isUndefined(e.getBikeSpeed())||(n.tm.bike.speed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.bike.uphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.bike.downhill=e.getBikeDownhill())),"walk"==i&&(n.tm.walk={},_.isUndefined(e.getWalkSpeed())||(n.tm.walk.speed=e.getWalkSpeed()),_.isUndefined(e.getWalkUphill())||(n.tm.walk.uphill=e.getWalkUphill()),_.isUndefined(e.getWalkDownhill())||(n.tm.walk.downhill=e.getWalkDownhill())),o.sources.push(n)
});var a=[];_.each(t,function(e){a.push("statistics="+e)}),_.has(r.PopulationService.cache,JSON.stringify(o)+a.join("&"))?(e.getWaitControl()&&e.getWaitControl().hide(),n(r.PopulationService.cache[JSON.stringify(o)+a.join("&")])):$.ajax({url:r.config.serviceUrl+r.config.serviceVersion+"/population?cfg="+encodeURIComponent(JSON.stringify(o))+"&cb=?&key="+r.config.serviceKey+"&"+a.join("&"),timeout:r.config.requestTimeout,dataType:"json",success:function(t){e.getWaitControl()&&e.getWaitControl().hide(),_.has(t,"data")?"ok"==t.code?(r.PopulationService.cache[JSON.stringify(o)+a.join("&")]=t.data,n(t.data)):_.isFunction(i)&&i(t.code,t.message):(r.PopulationService.cache[JSON.stringify(o)+a.join("&")]=t,n(t))},error:function(){e.getWaitControl()&&e.getWaitControl().hide(),_.isFunction(i)&&i("service-not-available","The population service is currently not available, please try again later.")}})}},r.RouteService={cache:{},getRoutes:function(e,t,n){e.getWaitControl()&&(e.getWaitControl().show(),e.getWaitControl().updateText(r.config.i18n.getSpan("routeWait")));var i={sources:[],targets:[],pathSerializer:e.getPathSerializer(),elevation:e.isElevationEnabled()};_.each(e.getSources(),function(t){var n={lat:_.has(t,"lat")?t.lat:t.getLatLng().lat,lng:_.has(t,"lon")?t.lon:_.has(t,"lng")?t.lng:t.getLatLng().lng,id:_.has(t,"id")?t.id:"",tm:{}},o=_.has(t,"travelType")?t.travelType:e.getTravelType();n.tm[o]={},("transit"==o||"biketransit"==o)&&(n.tm[o].frame={},_.isUndefined(e.getTime())||(n.tm[o].frame.time=e.getTime()),_.isUndefined(e.getDate())||(n.tm[o].frame.date=e.getDate())),"ebike"==o&&(n.tm.ebike={},_.isUndefined(e.getBikeSpeed())||(n.tm.ebike.speed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.ebike.uphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.ebike.downhill=e.getBikeDownhill())),"rentbike"==o&&(n.tm.rentbike={},_.isUndefined(e.getBikeSpeed())||(n.tm.rentbike.bikespeed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.rentbike.bikeuphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.rentbike.bikedownhill=e.getBikeDownhill()),_.isUndefined(e.getWalkSpeed())||(n.tm.rentbike.walkspeed=e.getWalkSpeed()),_.isUndefined(e.getWalkUphill())||(n.tm.rentbike.walkuphill=e.getWalkUphill()),_.isUndefined(e.getWalkDownhill())||(n.tm.rentbike.walkdownhill=e.getWalkDownhill())),"rentandreturnbike"==o&&(n.tm.rentandreturnbike={},_.isUndefined(e.getBikeSpeed())||(n.tm.rentandreturnbike.bikespeed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.rentandreturnbike.bikeuphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.rentandreturnbike.bikedownhill=e.getBikeDownhill()),_.isUndefined(e.getWalkSpeed())||(n.tm.rentandreturnbike.walkspeed=e.getWalkSpeed()),_.isUndefined(e.getWalkUphill())||(n.tm.rentandreturnbike.walkuphill=e.getWalkUphill()),_.isUndefined(e.getWalkDownhill())||(n.tm.rentandreturnbike.walkdownhill=e.getWalkDownhill())),"bike"==o&&(n.tm.bike={},_.isUndefined(e.getBikeSpeed())||(n.tm.bike.speed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.bike.uphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.bike.downhill=e.getBikeDownhill())),"walk"==o&&(n.tm.walk={},_.isUndefined(e.getWalkSpeed())||(n.tm.walk.speed=e.getWalkSpeed()),_.isUndefined(e.getWalkUphill())||(n.tm.walk.uphill=e.getWalkUphill()),_.isUndefined(e.getWalkDownhill())||(n.tm.walk.downhill=e.getWalkDownhill())),i.sources.push(n)}),i.targets=[],_.each(e.getTargets(),function(e){i.targets.push({lat:_.has(e,"lat")?e.lat:e.getLatLng().lat,lng:_.has(e,"lon")?e.lon:_.has(e,"lng")?e.lng:e.getLatLng().lng,id:_.has(e,"id")?e.id:""})}),_.has(r.RouteService.cache,JSON.stringify(i))?(e.getWaitControl()&&e.getWaitControl().hide(),t(r.Util.parseRoutes(JSON.parse(JSON.stringify(r.RouteService.cache[JSON.stringify(i)]))))):$.ajax({url:r.config.serviceUrl+r.config.serviceVersion+"/route?cfg="+encodeURIComponent(JSON.stringify(i))+"&cb=?&key="+r.config.serviceKey,timeout:r.config.requestTimeout,dataType:"json",success:function(o){e.getWaitControl()&&e.getWaitControl().hide(),_.has(o,"data")?"ok"==o.code?(r.RouteService.cache[JSON.stringify(i)]=JSON.parse(JSON.stringify(o.data)),t(r.Util.parseRoutes(o.data))):_.isFunction(n)&&n(o.code,o.message):(r.RouteService.cache[JSON.stringify(i)]=JSON.parse(JSON.stringify(o)),t(r.Util.parseRoutes(o)))},error:function(){e.getWaitControl()&&e.getWaitControl().hide(),_.isFunction(n)&&n("service-not-available","The routing service is currently not available, please try again later.")}})}},r.TimeService={cache:{},getRouteTime:function(e,t,n){e.getWaitControl()&&(e.getWaitControl().show(),e.getWaitControl().updateText(r.config.i18n.getSpan("timeWait")));var i={sources:[],targets:[],pathSerializer:e.getPathSerializer(),maxRoutingTime:e.getMaxRoutingTime()};_.isUndefined(e.isElevationEnabled())||(i.elevation=e.isElevationEnabled()),_.isUndefined(e.getTravelTimes())&&_.isUndefined(e.getIntersectionMode())&&_.isUndefined(e.getRenderWatts())&&_.isUndefined(e.getSupportWatts())||(i.polygon={},_.isUndefined(e.getTravelTimes())||(i.polygon.values=e.getTravelTimes()),_.isUndefined(e.getIntersectionMode())||(i.polygon.intersectionMode=e.getIntersectionMode()),_.isUndefined(e.getRenderWatts())||(i.polygon.renderWatts=e.getRenderWatts()),_.isUndefined(e.getSupportWatts())||(i.polygon.supportWatts=e.getSupportWatts()),_.isUndefined(e.getMinPolygonHoleSize())||(i.polygon.minPolygonHoleSize=e.getMinPolygonHoleSize())),_.each(e.getSources(),function(t){var n={lat:_.has(t,"lat")?t.lat:t.getLatLng().lat,lng:_.has(t,"lon")?t.lon:_.has(t,"lng")?t.lng:t.getLatLng().lng,id:_.has(t,"id")?t.id:"",tm:{}},o=_.has(t,"travelType")?t.travelType:e.getTravelType();n.tm[o]={},("transit"==o||"biketransit"==o)&&(n.tm[o].frame={},_.isUndefined(e.getTime())||(n.tm[o].frame.time=e.getTime()),_.isUndefined(e.getDate())||(n.tm[o].frame.date=e.getDate())),"ebike"==o&&(n.tm.ebike={},_.isUndefined(e.getBikeSpeed())||(n.tm.ebike.speed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.ebike.uphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.ebike.downhill=e.getBikeDownhill())),"rentbike"==o&&(n.tm.rentbike={},_.isUndefined(e.getBikeSpeed())||(n.tm.rentbike.bikespeed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.rentbike.bikeuphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.rentbike.bikedownhill=e.getBikeDownhill()),_.isUndefined(e.getWalkSpeed())||(n.tm.rentbike.walkspeed=e.getWalkSpeed()),_.isUndefined(e.getWalkUphill())||(n.tm.rentbike.walkuphill=e.getWalkUphill()),_.isUndefined(e.getWalkDownhill())||(n.tm.rentbike.walkdownhill=e.getWalkDownhill())),"rentandreturnbike"==o&&(n.tm.rentandreturnbike={},_.isUndefined(e.getBikeSpeed())||(n.tm.rentandreturnbike.bikespeed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.rentandreturnbike.bikeuphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.rentandreturnbike.bikedownhill=e.getBikeDownhill()),_.isUndefined(e.getWalkSpeed())||(n.tm.rentandreturnbike.walkspeed=e.getWalkSpeed()),_.isUndefined(e.getWalkUphill())||(n.tm.rentandreturnbike.walkuphill=e.getWalkUphill()),_.isUndefined(e.getWalkDownhill())||(n.tm.rentandreturnbike.walkdownhill=e.getWalkDownhill())),"bike"==o&&(n.tm.bike={},_.isUndefined(e.getBikeSpeed())||(n.tm.bike.speed=e.getBikeSpeed()),_.isUndefined(e.getBikeUphill())||(n.tm.bike.uphill=e.getBikeUphill()),_.isUndefined(e.getBikeDownhill())||(n.tm.bike.downhill=e.getBikeDownhill())),"walk"==o&&(n.tm.walk={},_.isUndefined(e.getWalkSpeed())||(n.tm.walk.speed=e.getWalkSpeed()),_.isUndefined(e.getWalkUphill())||(n.tm.walk.uphill=e.getWalkUphill()),_.isUndefined(e.getWalkDownhill())||(n.tm.walk.downhill=e.getWalkDownhill())),i.sources.push(n)}),_.each(e.getTargets(),function(e){i.targets.push({lat:_.has(e,"lat")?e.lat:e.getLatLng().lat,lng:_.has(e,"lon")?e.lon:_.has(e,"lng")?e.lng:e.getLatLng().lng,id:_.has(e,"id")?e.id:""})}),_.has(r.TimeService.cache,JSON.stringify(i))?(e.getWaitControl()&&e.getWaitControl().hide(),t(r.TimeService.cache[JSON.stringify(i)])):$.ajax({url:r.config.serviceUrl+r.config.serviceVersion+"/time?key="+r.config.serviceKey,type:"POST",data:JSON.stringify(i),contentType:"application/json",timeout:r.config.requestTimeout,dataType:"json",success:function(o){e.getWaitControl()&&e.getWaitControl().hide(),_.has(o,"data")?"ok"==o.code?(r.TimeService.cache[JSON.stringify(i)]=o.data,t(o.data)):_.isFunction(n)&&n(o.code,o.message):(r.TimeService.cache[JSON.stringify(i)]=o,t(o))},error:function(){e.getWaitControl()&&e.getWaitControl().hide(),_.isFunction(n)&&n("service-not-available","The time service is currently not available, please try again later.")}})}},r.OsmService={cache:{},getPoisInBoundingBox:function(e,t,n,i,o){n&&(n.show(),n.updateText(r.config.i18n.getSpan("osmWait")));var a=$.param({tags:t},!0);"undefined"!=typeof e&&(a.northEast=e._northEast.lng+"|"+e._northEast.lat,a.southWest=e._southWest.lng+"|"+e._southWest.lat),_.has(r.OsmService.cache,a)?(n&&n.hide(),i(r.OsmService.cache[a])):$.ajax({url:r.config.osmServiceUrl+"pois/search?callback=?&"+a,timeout:r.config.requestTimeout,dataType:"json",success:function(e){n&&n.hide(),i(e)},error:function(){n&&n.hide(),_.isFunction(o)&&o("service-not-available","The travel time polygon service is currently not available, please try again later.")}})}},L.CRS={latLngToPoint:function(e,t){var n=this.projection.project(e),i=this.scale(t);return this.transformation._transform(n,i)},pointToLatLng:function(e,t){var n=this.scale(t),i=this.transformation.untransform(e,n);return this.projection.unproject(i)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},getProjectedBounds:function(e){if(this.infinite)return null;var t=this.projection.bounds,n=this.scale(e),i=this.transformation.transform(t.min,n),o=this.transformation.transform(t.max,n);return L.bounds(i,o)},wrapLatLng:function(e){var t=this.wrapLng?L.Util.wrapNum(e.lng,this.wrapLng,!0):e.lng,n=this.wrapLat?L.Util.wrapNum(e.lat,this.wrapLat,!0):e.lat,i=e.alt;return L.latLng(n,t,i)}},L.CRS.Earth=L.extend({},L.CRS,{wrapLng:[-180,180],R:6378137,distance:function(e,t){var n=Math.PI/180,i=e.lat*n,o=t.lat*n,r=Math.sin(i)*Math.sin(o)+Math.cos(i)*Math.cos(o)*Math.cos((t.lng-e.lng)*n);return this.R*Math.acos(Math.min(r,1))}}),r.polygon=function(e,t,n){return new r.Polygon(e,t,n)},r.Polygon=function(e,t,n){var i=this;i.topRight=new L.latLng(-90,-180),i.bottomLeft=new L.latLng(90,180),i.travelTime=e,i.area=t,i.color,i.outerBoundary=n,i.innerBoundaries=new Array,i.innerProjectedBoundaries=new Array,i.setOuterBoundary=function(e){i.outerBoundary=e},i.projectOuterBoundary=function(){i.outerProjectedBoundary=new Array;for(var e=0;e<i.outerBoundary.length;e++)i.outerProjectedBoundary.push(r.Util.webMercatorToLeaflet(i.outerBoundary[e]))},i.project=function(){i.projectOuterBoundary()},i.addInnerBoundary=function(e){var t={};t.projectedBottomLeft=new L.Point(20026377,20048967),t.projectedTopRight=new L.Point(-20026377,-20048967);for(var n=e.length-1;n>=0;n--)e[n].x>t.projectedTopRight.x&&(t.projectedTopRight.x=e[n].x),e[n].y>t.projectedTopRight.y&&(t.projectedTopRight.y=e[n].y),e[n].x<t.projectedBottomLeft.x&&(t.projectedBottomLeft.x=e[n].x),e[n].y<t.projectedBottomLeft.y&&(t.projectedBottomLeft.y=e[n].y);t.topRight=r.Util.webMercatorToLatLng(new L.Point(t.projectedTopRight.x,t.projectedTopRight.y)),t.bottomLeft=r.Util.webMercatorToLatLng(new L.Point(t.projectedBottomLeft.x,t.projectedBottomLeft.y)),t.projectedBottomLeft=r.Util.webMercatorToLeaflet(t.projectedBottomLeft),t.projectedTopRight=r.Util.webMercatorToLeaflet(t.projectedTopRight),t.points=new Array,i.innerProjectedBoundaries.push(t);for(var o=0;o<e.length;o++)t.points.push(r.Util.webMercatorToLeaflet(e[o]));t.getProjectedBottomLeft=function(){return new L.Point(this.projectedBottomLeft.x,this.projectedBottomLeft.y)},t.getProjectedTopRight=function(){return new L.Point(this.projectedTopRight.x,this.projectedTopRight.y)}},i.getBoundingBox=function(){return new L.LatLngBounds(this._bottomLeft,this._topRight)},i.getProjectedBottomLeft=function(){return new L.Point(i.projectedBottomLeft.x,i.projectedBottomLeft.y)},i.getProjectedTopRight=function(){return new L.Point(i.projectedTopRight.x,i.projectedTopRight.y)},i.setBoundingBox=function(){this.projectedBottomLeft=new L.Point(20026377,20048967),this.projectedTopRight=new L.Point(-20026377,-20048967);for(var e=this.outerBoundary.length-1;e>=0;e--)this.outerBoundary[e].x>this.projectedTopRight.x&&(this.projectedTopRight.x=this.outerBoundary[e].x),this.outerBoundary[e].y>this.projectedTopRight.y&&(this.projectedTopRight.y=this.outerBoundary[e].y),this.outerBoundary[e].x<this.projectedBottomLeft.x&&(this.projectedBottomLeft.x=this.outerBoundary[e].x),this.outerBoundary[e].y<this.projectedBottomLeft.y&&(this.projectedBottomLeft.y=this.outerBoundary[e].y);this.topRight=r.Util.webMercatorToLatLng(new L.Point(this.projectedTopRight.x,this.projectedTopRight.y)),this.bottomLeft=r.Util.webMercatorToLatLng(new L.Point(this.projectedBottomLeft.x,this.projectedBottomLeft.y)),this.projectedTopRight=r.Util.webMercatorToLeaflet(this.projectedTopRight),this.projectedBottomLeft=r.Util.webMercatorToLeaflet(this.projectedBottomLeft)},i.setBoundingBox(),i.getColor=function(){return i.color},i.setTravelTime=function(e){i.travelTime=e},i.getTravelTime=function(){return i.travelTime},i.setColor=function(e){i.color=e},i.setOpacity=function(e){i.opacity=e},i.getOpacity=function(){return i.opacity},i.setArea=function(e){i.area=e},i.getArea=function(){return i.area}},r.MultiPolygon=function(){var e=this;e._topRight=new L.latLng(-90,-180),e._bottomLeft=new L.latLng(90,180),e.travelTime,e.color,e.polygons=new Array,e.addPolygon=function(t){e.polygons.push(t)},e.setOpacity=function(t){e.opacity=t},e.getOpacity=function(){return e.opacity},e.setColor=function(t){e.color=t},e.getColor=function(){return e.color},e.getTravelTime=function(){return e.travelTime},e.setTravelTime=function(t){e.travelTime=t},e.getBoundingBox=function(){return new L.LatLngBounds(e._bottomLeft,e._topRight)},e.setBoundingBox=function(){_.each(e.polygons,function(t){t._topRight.lat>e._topRight.lat&&(e._topRight.lat=t._topRight.lat),t._bottomLeft.lat<e._bottomLeft.lat&&(e._bottomLeft.lat=t._bottomLeft.lat),t._topRight.lng>e._topRight.lng&&(e._topRight.lng=t._topRight.lng),t._bottomLeft.lng<e._bottomLeft.lng&&(e._bottomLeft.lng=t._bottomLeft.lng)})}},r.multiPolygon=function(){return new r.MultiPolygon},L.Bounds=function(e,t){if(e)for(var n=t?[e,t]:e,i=0,o=n.length;o>i;i++)this.extend(n[i])},L.Bounds.prototype={extend:function(e){return e=L.point(e),this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(e.y,this.max.y)):(this.min=e.clone(),this.max=e.clone()),this},getCenter:function(e){return new L.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return new L.Point(this.min.x,this.max.y)},getTopRight:function(){return new L.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var t,n;return e="number"==typeof e[0]||e instanceof L.Point?L.point(e):L.bounds(e),e instanceof L.Bounds?(t=e.min,n=e.max):t=n=e,t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=L.bounds(e);var t=this.min,n=this.max,i=e.min,o=e.max,r=o.x>=t.x&&i.x<=n.x,a=o.y>=t.y&&i.y<=n.y;return r&&a},overlaps:function(e){e=L.bounds(e);var t=this.min,n=this.max,i=e.min,o=e.max,r=o.x>t.x&&i.x<n.x,a=o.y>t.y&&i.y<n.y;return r&&a},isValid:function(){return!(!this.min||!this.max)}},L.bounds=function(e,t){return!e||e instanceof L.Bounds?e:new L.Bounds(e,t)},r.Point=function(e,t,n){this.x=n?Math.round(e):e,this.y=n?Math.round(t):t},r.Point.prototype={clone:function(){return new r.Point(this.x,this.y)},add:function(e){return this.clone()._add(r.point(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(r.point(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(e){e=r.point(e);var t=e.x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},equals:function(e){return e=r.point(e),e.x===this.x&&e.y===this.y},contains:function(e){return e=r.point(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+r.Utir360.formatNum(this.x)+", "+r.Utir360.formatNum(this.y)+")"}},r.point=function(e,t,i){return e instanceof r.Point?e:r.Utir360.isArray(e)?new r.Point(e[0],e[1]):e===n||null===e?e:new r.Point(e,t,i)},L.LatLng=function(e,t,i){if(isNaN(e)||isNaN(t))throw new Error("Invalid LatLng object: ("+e+", "+t+")");this.lat=+e,this.lng=+t,i!==n&&(this.alt=+i)},L.LatLng.prototype={equals:function(e,t){if(!e)return!1;e=L.latLng(e);var i=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return(t===n?1e-9:t)>=i},toString:function(e){return"LatLng("+L.Util.formatNum(this.lat,e)+", "+L.Util.formatNum(this.lng,e)+")"},distanceTo:function(e){return L.CRS.Earth.distance(this,L.latLng(e))},wrap:function(){return L.CRS.Earth.wrapLatLng(this)},toBounds:function(e){var t=180*e/40075017,n=t/Math.cos(Math.PI/180*this.lat);return L.latLngBounds([this.lat-t,this.lng-n],[this.lat+t,this.lng+n])},clone:function(){return new L.LatLng(this.lat,this.lng,this.alt)}},L.latLng=function(e,t,i){return e instanceof L.LatLng?e:L.Util.isArray(e)&&"object"!=typeof e[0]?3===e.length?new L.LatLng(e[0],e[1],e[2]):2===e.length?new L.LatLng(e[0],e[1]):null:e===n||null===e?e:"object"==typeof e&&"lat"in e?new L.LatLng(e.lat,"lng"in e?e.lng:e.lon,e.alt):t===n?null:new L.LatLng(e,t,i)},r.RouteSegment=function(e){var t=this;if(t.points=[],t.type=e.type,t.travelTime=e.travelTime,t.distance=e.length/1e3,t.warning=e.warning,t.elevationGain=e.elevationGain,t.errorMessage,t.transitSegment=!1,t.startname=e.startname,t.endname=e.endname,_.each(e.points,function(e){t.points.push(r.Util.webMercatorToLatLng(new L.Point(e[1],e[0]),e[2]))}),e.isTransit){var n=_.findWhere(r.config.routeTypes,{routeType:e.routeType});t.color="undefined"!=typeof n&&_.has(n,"color")?n.color:"RED",t.haloColor="undefined"!=typeof n&&_.has(n,"haloColor")?n.haloColor:"WHITE",t.transitSegment=!0,t.routeType=e.routeType,t.routeShortName=e.routeShortName,t.startname=e.startname,t.endname=e.endname,t.departureTime=e.departureTime,t.arrivalTime=e.arrivalTime,t.tripHeadSign=e.tripHeadSign}else{var n=_.findWhere(r.config.routeTypes,{routeType:e.type});t.color="undefined"!=typeof n&&_.has(n,"color")?n.color:"RED",t.haloColor="undefined"!=typeof n&&_.has(n,"haloColor")?n.haloColor:"WHITE"}t.getPoints=function(){return t.points},t.getType=function(){return t.type},t.getHaloColor=function(){return t.haloColor},t.getColor=function(){return t.color},t.getTravelTime=function(){return t.travelTime},t.getDistance=function(){return t.distance},t.getRouteType=function(){return t.routeType},t.getRouteShortName=function(){return t.routeShortName},t.getStartName=function(){return t.startname},t.getEndName=function(){return t.endname},t.getDepartureTime=function(){return t.departureTime},t.getArrivalTime=function(){return t.arrivalTime},t.getTripHeadSign=function(){return t.tripHeadSign},t.getWarning=function(){return t.warning},t.getElevationGain=function(){return t.elevationGain},t.isTransit=function(){return t.transitSegment}},r.routeSegment=function(e){return new r.RouteSegment(e)},r.Route=function(e,t){var i=this;i.travelTime=e,i.routeSegments=[],i.points=[],i.uphillMeter=0,i.downhillMeter=0,i.targetHeight=n,i.sourceHeight=n,_.each(t.reverse(),function(e){var t=r.routeSegment(e);i.routeSegments.push(t),i.points=i.points.concat(t.getPoints().reverse())}),i.equals=function(e){return i.getKey()===e.getKey()},i.getKey=function(){var t=e,n="";return _.each(i.getSegments(),function(e){t+=" "+e.getRouteShortName()+" "+e.getDepartureTime()+" "+e.getArrivalTime(),_.each(e.getPoints(),function(e){n+=" "+e.lat+e.lng})}),t+n},i.addRouteSegment=function(e){i.routeSegments.push(e)},i.setTravelTime=function(e){i.travelTime=e},i.getDistance=function(){for(var e=0,t=0;t<i.routeSegments.length;t++)e+=i.routeSegments[t].getDistance();return e},i.getElevationGain=function(){for(var e=0,t=0;t<i.routeSegments.length;t++)e+=i.routeSegments[t].getElevationGain();return e},i.getElevations=function(){for(var e={x:[],y:[]},t=0;t<1e3*i.getDistance();t+=100)e.x.push(t/1e3+" km"),e.y.push(i.getElevationAt(t));return e},i.getElevationAt=function(e){for(var t=0,n=1;n<i.points.length;n++){var o=i.points[n-1],r=i.points[n],a=o.distanceTo(r);if(t+=a,t>e)return r.alt}},i.getSegments=function(){return i.routeSegments},i.getUphillElevation=function(){return i.uphillMeter},i.getDownhillElevation=function(){return i.downhillMeter},i.getTotalElevationDifference=function(){return Math.abs(i.sourceHeight-i.targetHeight)},i.setElevationDifferences=function(){for(var e=n,t=i.points.length-1;t>=0;t--)0==t&&(i.targetHeight=i.points[t].alt),t==i.points.length-1&&(i.sourceHeight=i.points[t].alt),"undefined"!=typeof e&&(e>i.points[t].alt?i.uphillMeter+=e-i.points[t].alt:e<i.points[t].alt&&(i.downhillMeter+=i.points[t].alt-e)),e=i.points[t].alt}(),i.getTravelTime=function(){return i.travelTime},i.fadeIn=function(e,t,n,o,r){function a(e){segment=i.routeSegments[e],percent="travelTime"==n?segment.getTravelTime()/i.getTravelTime():segment.getDistance()/i.getDistance(),timeToDraw=percent*t,"TRANSFER"!=segment.getType()?g(segment,timeToDraw,o,e):(("undefined"==typeof o||o.paintTransfer||"undefined"!=typeof o&&!_.has(o,"paintTransfer"))&&l(segment,o),++e<i.routeSegments.length&&a(e))}function l(e,t){s(e.points[0],e,t),e.points.length>1&&e.points[0].lat!=e.points[1].lat&&e.points[0].lng!=e.points[1].lng&&s(e.points[1],e,t)}function s(t,n,i){var o=L.circleMarker(t,{color:!_.isUndefined(i)&&_.has(i,"transferColor")?i.transferColor:n.getColor(),fillColor:!_.isUndefined(i)&&_.has(i,"transferHaloColor")?i.transferHaloColor:"undefined"!=typeof n.getHaloColor()?n.getHaloColor():"#9D9D9D",fillOpacity:!_.isUndefined(i)&&_.has(i,"transferFillOpacity")?i.transferFillOpacity:1,opacity:!_.isUndefined(i)&&_.has(i,"transferOpacity")?i.transferOpacity:1,stroke:!_.isUndefined(i)&&_.has(i,"transferStroke")?i.transferStroke:!0,weight:!_.isUndefined(i)&&_.has(i,"transferWeight")?i.transferWeight:4,radius:!_.isUndefined(i)&&_.has(i,"transferRadius")?i.transferRadius:8}),r=!_.isUndefined(i)&&_.has(i,"popup")?i.popup:"INSERT_TEXT";if("undefined"!=typeof n){var a=_.contains(["walk","transit","source","target","bike","car"],n.startname)?"":n.startname;a=""!=a||_.contains(["walk","transit","source","target","bike","car"],n.endname)?a:n.endname,r=r.replace("INSERT_TEXT",a)}!_.isUndefined(i)&&_.has(i,"popup")&&(o.bindPopup(r),o.on("mouseover",function(){o.openPopup()})),o.addTo(e),o.bringToFront()}function g(t,n,i,o){var a={};a.color=!_.isUndefined(i)&&_.has(i,"color")?i.color:t.getColor(),a.opacity=!_.isUndefined(i)&&_.has(i,"opacity")?i.opacity:.8,a.weight=!_.isUndefined(i)&&_.has(i,"weight")?i.weight:5,"TRANSIT"!=t.getType()&&"WALK"==t.getType()&&(a.color=!_.isUndefined(i)&&_.has(i,"walkColor")?i.walkColor:"#006F35",a.weight=!_.isUndefined(i)&&_.has(i,"walkWeight")?i.walkWeight:7,a.dashArray=!_.isUndefined(i)&&_.has(i,"walkDashArray")?i.walkDashArray:"1, 10");var l={};l.weight=!_.isUndefined(i)&&_.has(i,"haloWeight")?i.haloWeight:10,l.opacity=!_.isUndefined(i)&&_.has(i,"haloOpacity")?i.haloOpacity:.7,l.color=!_.isUndefined(i)&&_.has(i,"haloColor")?i.haloColor:"undefined"!=typeof t.getHaloColor()?t.getHaloColor():"#9D9D9D";var s=n/15,g=u(t.getPoints(),s),d=L.polyline(g[0],l).addTo(e),c=L.polyline(g[0],a).addTo(e);d.on("click",r),c.on("click",r),h(c,d,g,1,o)}function h(e,t,n,o,r){for(var l=e.getLatLngs(),s=0;s<n[o].length;s++)l.push(n[o][s]);0!=l.length&&(t.setLatLngs(l),e.setLatLngs(l)),++o<n.length?setTimeout(function(){h(e,t,n,o,r)},15):++r<i.routeSegments.length&&a(r)}function u(e,t){for(var n,i,o=0,r=1/t,a=0,l=new Array,s=1;s<e.length;s++)o+=e[s-1].distanceTo(e[s]);for(var g=new Array,s=0;s<e.length-1;s++)if(g.push(e[s]),n=e[s].distanceTo(e[s+1]),i=n/o,a+=i,a>=r)for(;a>=r;)percent=(r-(a-i))/i,g.push(d(e[s],e[s+1],percent)),r+=1/t,l.push(g),g=new Array;return l.push(g),g=new Array,g.push(e[e.length-1]),l.push(g),l}function d(t,n,i){var o;o="undefined"!=typeof e.project?e:e._map;var r=o.project(t),a=o.project(n),l=(a.x-r.x)*i+r.x,s=(a.y-r.y)*i+r.y,g=new L.point(l,s),h=o.unproject(g);return h}"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n="travelTime"),a(0)}},r.route=function(e,t){return new r.Route(e,t)}}(window,document);